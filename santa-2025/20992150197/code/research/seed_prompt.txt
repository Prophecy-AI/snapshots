# Santa 2025 - Christmas Tree Packing Challenge: Evolved Strategy

## Current Status
- Best CV/LB score: ~217.57 (Baseline Grid)
- CV-LB gap: 0.00 (Perfect calibration)
- Target: < 69.0 (Need ~68% reduction)

## Response to Evaluator
- **Technical Verdict:** TRUSTWORTHY but BASIC.
- **Evaluator's Top Priority:** Implement "Interlocked Grid" with validation.
- **My Response:** Agreed. The baseline was just to establish the pipeline. The next step is clearly to exploit the geometry. I will implement the interlocked grid (alternating 0° and 180°) and, crucially, the validation check.
- **Key Concerns:** Lack of overlap check. I will address this by implementing a `validate_packing` function using `shapely` or a custom SAT checker.

## Data Understanding
- **Tree Geometry:** The tree is arrow-shaped. A 180° tree fits perfectly between two 0° trees.
- **Optimal Pair:** Analysis found that a 0° and 180° tree can be packed with relative offset `dx=0.429`, `dy=0.480`. This is significantly tighter than the baseline `dx=0.75`, `dy=1.05`.
- **N=1 Optimization:** Rotating the single tree by 45° reduces the bounding box side from 1.0 to ~0.81, improving the score for N=1 by ~0.34 points.

## Recommended Approaches
Priority-ordered list:

1.  **Interlocked Grid Packing (High Impact)**
    -   **Concept:** Place trees in rows. Row $i$ has trees at $y = i \cdot dy$.
    -   **Orientation:** Even rows have 0°, Odd rows have 180°.
    -   **Shift:** Odd rows are shifted by $dx/2$ relative to even rows to nest the "tips" into the "valleys".
    -   **Parameters:** Use the discovered `dx=0.429`, `dy=0.480` as starting points, but implement a local search or "squeeze" to tighten them further for each $N$.
    -   **Validation:** MUST include `shapely.intersects` check.

2.  **N=1 Special Case (Quick Win)**
    -   Hardcode N=1 to use 45° rotation.

3.  **Local Search / "Jiggling" (Refinement)**
    -   After placing trees in the grid, try to move each tree slightly towards the center (0,0) or bottom-left.
    -   Accept move if valid and bounding box doesn't grow (or shrinks).

4.  **Global Rotation (Post-Processing)**
    -   Rotate the entire packed configuration by $\theta \in [0, 90]$ to find the orientation that minimizes the axis-aligned bounding box.

## What NOT to Try
-   **Random Placement:** Too inefficient for 200 trees.
-   **Genetic Algorithms (yet):** Need a better constructive heuristic first.
-   **Complex Physics Engines (yet):** Too much overhead for now; simple geometric heuristics will yield faster gains initially.

## Validation Notes
-   **CV Scheme:** Calculate exact score locally using `unary_union(polygons).bounds`.
-   **Overlap Check:** Strict `intersects` check. If overlap found, expand grid spacing until valid.
