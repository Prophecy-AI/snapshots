# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.572676 from snapshot 21145966992 (tree_packer_v21)
- Best LB score: 70.6600 (from exp_005, exp_006)
- Target: 68.919154 | Gap to target: 1.653522 (2.34%)

## CRITICAL DISCOVERY: Better Baseline Found!
Found a snapshot with score **70.572676** which is 0.087 better than our previous best of 70.659958!
This was achieved using tree_packer_v21.cpp which combines:
- Squeeze (scale toward center)
- Compaction (move individual trees toward center)
- Simulated Annealing with swap moves
- Local Search (8-directional + rotation)
- Multi-start with random angle restarts

## Response to Evaluator
The evaluator correctly identified that standard SA approaches have converged to a local optimum.
However, I discovered a snapshot with a BETTER score (70.572676 vs 70.659958) that was achieved
using tree_packer_v21.cpp. This is a 0.087 improvement! The key difference is:
1. **Swap moves** - exchange positions of two trees (not just single-tree perturbations)
2. **Multi-start with random angle restarts** - escape local optima by rotating all trees
3. **Squeeze + Compaction + SA + Local Search** pipeline

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Submit the new baseline (70.572676)
We have a submission file with score 70.572676 ready at /home/submission/submission.csv.
This is 0.087 better than our previous best LB of 70.66.
**SUBMIT THIS IMMEDIATELY to get LB feedback!**

### 2. **[HIGH PRIORITY]** Run tree_packer_v21 for longer
The snapshot used -n 10000 -r 16 (10k iterations, 16 restarts).
Try running with much higher parameters:
- `-n 100000 -r 64` (100k iterations, 64 restarts)
- Run for 1+ hours
- The optimizer is at /home/nonroot/snapshots/santa-2025/21145966992/code/experiments/001_baseline/tree_packer_v21

### 3. **[HIGH PRIORITY]** Combine with eazy-optimizer
The eazy-optimizer uses unique techniques:
- Complex Orbital Moves (rotation in complex plane)
- Square Calculus Pressure (log-barrier gradient)
- Elastic Pulse (periodic squeeze/relax)
- Multi-scale optimization (1e-3, 1e-5, 1e-7, 1e-9)

Run eazy-optimizer on the new baseline and see if it finds further improvements.

### 4. **[MEDIUM PRIORITY]** Backward Propagation
Use N config to improve N-1 config:
- For each N from 200 down to 2
- Try removing each tree that touches the bounding box
- If resulting (N-1) config is better than stored, save it

### 5. **[MEDIUM PRIORITY]** Ensemble best-per-N
Compare scores per N between:
- tree_packer_v21 output (70.572676)
- eazy-optimizer output (70.659943)
- saspav_latest baseline (70.659958)
Take the best configuration for each N value.

## What NOT to Try
- Random restart SA from scratch (already tried, no improvement)
- Long SA from baseline without swap moves (already tried, no improvement)
- Simple perturbation (baseline is too tight)

## Validation Notes
- CV = LB for this optimization problem (no distribution shift)
- Always check for overlaps before submission
- Use the scoring function: Σ(side²/N)

## Key Technical Notes
- Use `long double` in C++ for maximum precision
- The tree_packer_v21.cpp is the most advanced optimizer found
- Compile with: g++ -O3 -march=native -std=c++17 -fopenmp -o tree_packer_v21 tree_packer_v21.cpp

## SUBMISSION STRATEGY
- Remaining submissions: 95 (abundant!)
- **SUBMIT IMMEDIATELY** - we have a 0.087 improvement ready
- After submission, run tree_packer_v21 for longer to find more improvements
