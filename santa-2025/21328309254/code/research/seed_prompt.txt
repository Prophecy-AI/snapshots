# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- **Best CV score**: 70.523320 (from valid snapshot ensemble)
- **Previous best**: 70.624381 (best_snapshot.csv)
- **Target**: 68.894234
- **Gap to target**: 1.63 points (2.4%)
- **Submissions remaining**: 99

## CRITICAL DISCOVERY THIS LOOP
Found snapshot 21328310479 with score 70.523320 - a 0.101 point improvement!
Key improvements came from snapshot 21145966992:
- N=5: +0.023 points
- N=2: +0.013 points  
- N=56: +0.011 points
- N=55: +0.008 points
- N=4: +0.005 points

Source breakdown for optimal ensemble:
- preopt: 82 N values
- 21145966992: 57 N values
- 21322576827: 44 N values
- 21322577324: 10 N values
- 21322576451: 7 N values

## Response to Evaluator
The evaluator correctly identified that:
1. **bbox3 optimizer is available but unused** - AGREED. This is the next priority.
2. **No actual optimization has been attempted** - AGREED. We've only combined existing solutions.
3. **The 1.73 point gap requires fundamentally different approaches** - AGREED.

However, the systematic snapshot scan DID yield a significant improvement (0.101 points) by finding better solutions for small N values. This validates the ensemble approach as a quick win, but the evaluator is right that we need to run actual optimization to close the remaining 1.63 point gap.

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Submit the valid ensemble to get LB feedback
- Score: 70.523320
- This is 0.124 points better than our only LB submission (70.647327)
- We have 99 submissions - use them!

### 2. **[HIGH PRIORITY]** Run bbox3 optimizer on the new ensemble
The bbox3 binary is available at `/home/code/preoptimized/bbox3`. Run it on the improved ensemble:
```bash
chmod +x /home/code/preoptimized/bbox3
cp /home/submission/submission.csv /home/code/submission.csv
cd /home/code
./preoptimized/bbox3 -n 5000 -r 100
```
Start with moderate parameters, then scale up.

### 3. **[HIGH PRIORITY]** Investigate snapshot 21145966992
This snapshot has significantly better solutions for small N values. Check:
- What optimizer was used?
- What parameters?
- Can we extract the approach and apply it to other N values?

### 4. **[MEDIUM PRIORITY]** Focus on small N values (N=1-10)
These contribute ~6% of the total score but have the highest per-N contribution.
- N=1: 0.661 points (already optimal at 45Â°)
- N=2: 0.451 points (improved by 0.013 from snapshot)
- N=3: 0.435 points
- N=4: 0.353 points (improved by 0.005)
- N=5: 0.310 points (improved by 0.023)

Try exhaustive angle search for N=2-10.

### 5. **[MEDIUM PRIORITY]** Extended SA runs (hours, not minutes)
The saspav kernel uses:
- `shake_public` optimizer
- `bbox3` optimizer  
- `fix_direction` for rotation tightening
- MAX_HOURS = 11.6 (nearly 12 hours of optimization!)

We need to run optimization for HOURS to match top competitors.

## What NOT to Try
- More snapshot ensembling (diminishing returns - we've scanned all 100)
- Short optimization runs (need hours, not minutes)
- Invalid submissions (always check for overlapping trees)

## Validation Checklist
1. No overlapping trees (check for duplicate coordinates)
2. All coordinates within [-100, 100]
3. All 200 configurations present (20100 rows total)
4. Values prefixed with 's' in submission

## Key Files
- Best ensemble: `/home/submission/submission.csv` (70.523320)
- bbox3 optimizer: `/home/code/preoptimized/bbox3`
- Best snapshot: `/home/nonroot/snapshots/santa-2025/21145966992/`

## Submission Strategy
- **SUBMIT AGGRESSIVELY** - we have 99 submissions remaining
- Submit after every significant experiment
- LB feedback is free information - use it!
