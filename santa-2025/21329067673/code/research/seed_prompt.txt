# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.676102 from exp_000 (baseline)
- Best LB score: 70.676102 (confirmed - CV = LB for this optimization problem)
- Target: 68.894234 | Gap to target: 1.78 points (2.59%)

## Public Kernel Status (CRITICAL!)
- Have we implemented the best kernel yet? **NO** - Only loaded pre-optimized CSV
- Top kernels identified:
  1. jonathanchan/santa25-ensemble-sa-fractional-translation (176 votes) - Ensemble + SA + C++ optimizer
  2. jazivxt/why-not (352 votes) - bbox3 with fluid dynamics, lattice crystallization
  3. smartmanoj/santa-claude (378 votes) - Claude-assisted optimization
  4. yongsukprasertsuk/santa-2025-best-keeping-bbox3-runner (369 votes) - bbox3 runner
- Kernels we've implemented: NONE (only loaded pre-optimized submission)
- **CRITICAL**: The pre-optimized submission is at a tight local optimum - standard SA has failed to improve it

## CV-LB Relationship Analysis
- CV = LB perfectly (this is a pure optimization problem, no distribution shift)
- 1 submission: CV 70.676102 → LB 70.676102

## Response to Evaluator
The evaluator correctly identified:
1. **Tessellation/lattice approach for large N (N >= 58)** is the HIGHEST PRIORITY - NOT YET IMPLEMENTED
2. Large N values (51-200) contribute 73% of total score - biggest opportunity
3. The bbox3 C++ optimizer is available but not being used for long runs
4. Backward propagation (starting from N=200) could help

I AGREE with the evaluator's assessment. The next experiment should implement tessellation for large N values.

## Key Analysis Findings
1. **Score breakdown**:
   - N=1-10: 4.33 (6.1%) - Lowest efficiency (37-65%)
   - N=11-50: 14.71 (20.8%)
   - N=51-200: 51.63 (73.1%) - Highest total contribution, efficiency 68-73%

2. **Theoretical limits**:
   - Tree area = 0.245625
   - Theoretical minimum score = 49.125 (perfect packing)
   - Current gap from theoretical = 21.55 points
   - Target gap from theoretical = 19.77 points

3. **Rotation patterns**:
   - N=1: 45° (optimal)
   - N=2: ~204° and ~24° (symmetric pair)
   - Large N: Mix of angles, some show lattice patterns

## Recommended Approaches (Priority Order)

### 1. [HIGHEST PRIORITY] Implement Tessellation/Lattice for Large N (N >= 58)
The tessellation approach uses 2 base trees (one "blue" ~0°, one "pink" ~180°) in a grid pattern:
```python
def tessellation_pack(N, base_blue, base_pink, dx, dy):
    trees = []
    rows = cols = ceil(sqrt(N))
    for i in range(rows):
        for j in range(cols):
            if len(trees) >= N:
                break
            tree_type = (i + j) % 2  # Checkerboard pattern
            base = base_blue if tree_type == 0 else base_pink
            x = base.x + i * dx
            y = base.y + j * dy
            trees.append(ChristmasTree(x, y, base.angle))
    return trees
```
Target N values: 64, 81, 100, 121, 144, 169, 196, 200 (perfect squares and large N)

### 2. [HIGH PRIORITY] Run bbox3 C++ Optimizer with Long Runs
The bbox3 binary is available at `/home/nonroot/snapshots/santa-2025/21116303805/code/preoptimized/bbox3`
Parameters for long runs:
- `-n 15000+` iterations
- `-r 80+` rounds
- Use OpenMP parallelization (26 threads available)

### 3. [HIGH PRIORITY] Ensemble from Multiple Sources
Combine best configurations from:
- `/home/nonroot/snapshots/santa-2025/21116303805/code/preoptimized/` (30+ CSV files)
- For each N, take the configuration with smallest side length
- Validate for overlaps before combining

### 4. [MEDIUM PRIORITY] Focus on Small N (2-10)
These have lowest efficiency (37-65%) and could benefit from:
- Exhaustive rotation search (0.1° increments)
- Branch-and-bound for optimal placement
- Manual optimization using interactive editor

## What NOT to Try (Already Failed)
1. Short SA runs (< 10 minutes) - local optimum too tight
2. Simple ensemble without per-N comparison - doesn't help
3. Standard SA on pre-optimized solutions - already at local optimum
4. Backward propagation alone - doesn't escape local optima

## SUBMISSION STRATEGY
- Remaining submissions: 97
- **SUBMIT AGGRESSIVELY** - We have abundant submissions
- Submit after EVERY experiment to get LB feedback
- Even failed approaches teach us what doesn't work

## Validation Notes
- CV = LB for this optimization problem (no distribution shift)
- Always validate for overlaps before submission
- Use Decimal precision for coordinates
- Prefix coordinates with 's' (e.g., "s0.123456789")