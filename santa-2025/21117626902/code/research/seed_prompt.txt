# Santa 2025 Christmas Tree Packing - Evolved Seed Prompt (Loop 2)

## Current Status
- Best CV score: 70.676092 from ensemble of 8 sources
- Best LB score: 70.743774 (from exp_000)
- Target: 68.922808 | Gap to target: 1.75 points (2.5%)

## Public Kernel Status (CRITICAL!)
- Have we implemented the best kernel yet? **PARTIALLY** - We have downloaded datasets and kernel outputs
- Top kernels identified:
  - saspav/santa-submission (401 votes) - uses santa-2025.csv dataset (70.676)
  - jazivxt/why-not (292 votes) - bbox3 optimizer
  - jonathanchan/santa25-ensemble-sa-fractional-translation (174 votes) - ensemble approach
- Kernels we've implemented: Downloaded outputs from jazivxt, eazy-optimizer, ashraful
- **Key insight**: The best public score we found is 70.676 from santa-2025.csv

## Ensemble Strategy
- Models available for ensemble: 8 sources (preoptimized, 71.97, 72.49, santa-2025, telegram, jazivxt, eazy, ashraful)
- Current ensemble score: 70.676092
- The ensemble provides marginal improvement by picking best config per N
- **santa-2025.csv contributes 191 of 200 N values** - it's the dominant source

## CV-LB Relationship Analysis
- Only 1 submission so far (70.743774 CV = 70.743774 LB)
- This is a deterministic optimization problem - CV should equal LB exactly
- No CV-LB gap issue here - the problem is finding better solutions

## Response to Evaluator
The evaluator correctly identified that:
1. **Local search on a local optimum is futile** - Confirmed by experiment 002 where bbox3, sa_v1_parallel, backward propagation, and aggressive SA all failed to improve
2. **Ensemble approach is the right pivot** - We implemented this and achieved 70.676092
3. **The gap of 1.75 points is still large** - We need fundamentally better solutions

**Key observation**: All public sources we found score around 70.67-70.74. The target of 68.92 requires solutions that are ~2.5% better than anything publicly available.

## Critical Analysis: Why We're Stuck at 70.67

The best public solutions all converge around 70.67-70.74. This suggests:
1. **The public solutions share similar optimization approaches** (simulated annealing, local search)
2. **The target 68.92 requires techniques not in public kernels**
3. **Possible approaches to break through**:
   - Crystalline/lattice packing for large N (N > 58)
   - Better initial configurations (not random starts)
   - Longer optimization runs (hours, not minutes)
   - Different move operators (not just translation/rotation)

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Run Extended Optimization on Ensemble
The ensemble (70.676) is our best starting point. Run bbox3 optimizer for HOURS:
```bash
cd /home/code/experiments/003_extended_optimization
cp /home/submission/submission.csv submission.csv
# Compile bbox3 with maximum optimization
g++ -O3 -march=native -std=c++17 -fopenmp -o bbox3 bbox3.cpp
# Run for extended time with high iterations
export OMP_NUM_THREADS=$(nproc)
timeout 7200 ./bbox3 -n 100000 -r 512 -i submission.csv -o submission_optimized.csv
```

### 2. **[HIGH PRIORITY]** Implement Crystalline Packing for Large N
For N > 58, regular geometric lattices are mathematically superior:
- Grid arrangements (e.g., 6x12=72, 7x14=98)
- Hexagonal packing patterns
- The egortrushin kernel has translation-based lattice approach

### 3. **[MEDIUM PRIORITY]** Target Worst N Values
The worst N values contribute most to the score:
- N=1: 0.661250 (should be optimal at 45° rotation)
- N=2: 0.450779
- N=3: 0.434745
Focus optimization effort on these specific N values.

### 4. **[MEDIUM PRIORITY]** Download More Kernel Outputs
There may be better solutions in other kernel outputs:
```bash
kaggle kernels output hvanphucs112/bbox3-ensemble-update -p datasets/bbox3_ensemble
kaggle kernels output datafad/new-year-same-old-bbox -p datasets/datafad
kaggle kernels output chistyakov/santa-2025-simple-optimization-new-slow-version -p datasets/chistyakov
```

## What NOT to Try
- More local search on the same starting point (already proven futile)
- Short optimization runs (need hours, not minutes)
- Random restarts without better initial configurations

## Validation Notes
- This is a deterministic optimization problem
- CV = LB (no gap)
- Score = sum(side²/N) for N=1 to 200
- Lower is better
- No overlapping trees allowed

## SUBMISSION STRATEGY
- Remaining submissions: 93
- Submit after this experiment? **YES** - We have abundant submissions and need LB feedback
- The ensemble score (70.676) is better than our previous submission (70.744)

## Technical Details

### Tree Polygon Vertices (15 points)
```cpp
const double TX[15] = {0, 0.125, 0.0625, 0.2, 0.1, 0.35, 0.075, 0.075, -0.075, -0.075, -0.35, -0.1, -0.2, -0.0625, -0.125};
const double TY[15] = {0.8, 0.5, 0.5, 0.25, 0.25, 0, 0, -0.2, -0.2, 0, 0, 0.25, 0.25, 0.5, 0.5};
```

### Available Datasets
- /home/code/datasets/santa-2025.csv (70.676)
- /home/code/datasets/71.97.csv (71.97)
- /home/code/datasets/72.49.csv (72.49)
- /home/code/datasets/submission.csv (telegram, 70.676)
- /home/code/datasets/jazivxt_output/submission.csv (70.676)
- /home/code/datasets/eazy_output/submission.csv (70.699)
- /home/code/datasets/ashraful_output/submission.csv (70.734)
- /home/code/preoptimized_submission.csv (70.744)

### Key Insight from Research
- N < 58: Simulated annealing for unstructured packings
- N > 58: Crystalline/lattice packing is mathematically superior
- Top competitors use hybrid approach combining both
