# Santa 2025 Christmas Tree Packing - Seed Prompt (Loop 6)

## Current Status
- Best CV score: 70.675510 from exp_005 (006_corner_extraction)
- Best LB score: 70.676145 (exp_003, exp_004)
- Target: 68.922808 | Gap to target: 1.75 points (2.5% reduction needed)
- Remaining submissions: 91 (ABUNDANT - submit after every experiment!)

## Public Kernel Status (CRITICAL!)
- Have we implemented the best kernel yet? **PARTIALLY**
- Top kernels identified:
  - jiweiliu/super-fast-simulated-annealing-with-translations (claims ~0.15 improvement)
  - sacuscreed/santa2025-solutions-guided-refinement (guided refinement)
  - egortrushin/santa25-simulated-annealing-with-translations (SA with translations)
- Kernels we've implemented: bbox3, corner extraction (chistyakov), ensemble
- **Kernels NOT yet implemented**: jiweiliu deletion cascade, grid-based initialization, guided refinement

## CV-LB Relationship Analysis
- CV and LB scores match exactly (deterministic problem)
- No distribution shift - this is a pure optimization problem
- Improvement in CV = Improvement in LB

## Response to Evaluator
The evaluator correctly identified that:
1. Corner extraction yielded only 0.000634 improvement - far below the 1.75 points needed
2. The jiweiliu kernel's deletion cascade technique has NOT been implemented
3. Grid-based initialization with SA hasn't been tried
4. The target of 68.92 is BETTER than the current #1 on the leaderboard (71.19)

I AGREE with all these points. The evaluator's recommendation to implement the jiweiliu deletion cascade is the highest priority.

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Implement jiweiliu Deletion Cascade
The jiweiliu kernel (`research/kernels/jiweiliu_super-fast-simulated-annealing-with-translations/`) contains a deletion cascade technique that:
- Propagates good large configs to smaller sizes
- Iteratively removes the tree that minimizes bounding box
- Claims ~0.15 improvement in under 2 minutes

**EXPLICIT IMPLEMENTATION STEPS:**
```python
# Copy the deletion cascade function from jiweiliu kernel
# Key function: deletion_cascade_numba(xs, ys, degs, target_ns)

# For each large N configuration (N=200 down to N=2):
#   1. Get current configuration
#   2. Find tree to remove that minimizes bounding box
#   3. Remove that tree
#   4. Check if this is better than current best for this smaller N
#   5. Keep the best configuration for each N encountered
```

### 2. **[HIGH PRIORITY]** Implement Grid-Based Initialization with SA
The jiweiliu kernel generates configurations from grid patterns:
- ncols × nrows × 2 trees per cell
- Add extra trees at edges for non-multiple counts
- Run SA optimization on each grid configuration

**EXPLICIT IMPLEMENTATION STEPS:**
```python
# Generate grid configurations
grid_configs = []
for ncols in range(1, 11):
    for nrows in range(1, 11):
        for append_x in [False, True]:
            for append_y in [False, True]:
                n_base = 2 * ncols * nrows
                n_append_x = nrows if append_x else 0
                n_append_y = ncols if append_y else 0
                n_trees = n_base + n_append_x + n_append_y
                if n_trees <= 200:
                    grid_configs.append((ncols, nrows, append_x, append_y))

# For each grid config, run SA optimization
# Then apply deletion cascade to propagate to smaller N
```

### 3. **[MEDIUM PRIORITY]** Implement Guided Refinement from sacuscreed
The sacuscreed kernel (`research/kernels/sacuscreed_santa2025-solutions-guided-refinement/`) uses:
- Iterative refinement approach
- Can be mixed with SA for continuous improvements

### 4. **[LOWER PRIORITY]** Focus on Worst N Values
- N=1 contributes 0.661250 (highest single contribution)
- N=2 contributes 0.450779
- N=3 contributes 0.434745
- Small N values (1-10) contribute disproportionately to the score

## What NOT to Try
- ❌ More corner extraction (yielded only 0.000634 improvement)
- ❌ More bbox3 optimization (already at local optimum)
- ❌ More SA on existing configurations (already optimized)
- ❌ Building from scratch when jiweiliu kernel code exists

## SUBMISSION STRATEGY
- Remaining submissions: 91 (ABUNDANT!)
- **Submit after EVERY experiment** - LB feedback is free
- Submit exp_005 (006_corner_extraction) first to verify the 70.675510 score

## Key Code Locations
- jiweiliu kernel: `research/kernels/jiweiliu_super-fast-simulated-annealing-with-translations/super-fast-simulated-annealing-with-translations.ipynb`
- sacuscreed kernel: `research/kernels/sacuscreed_santa2025-solutions-guided-refinement/santa2025-solutions-guided-refinement.ipynb`
- Current submission: `/home/submission/submission.csv`

## Validation Notes
- This is a deterministic optimization problem
- CV = LB (no distribution shift)
- All configurations must have NO OVERLAPS
- Coordinates must be in [-100, 100]

## CRITICAL REMINDER
The target of 68.92 is BELOW the current #1 on the leaderboard (71.19). This means:
1. No public solution achieves this score
2. We need to GENERATE fundamentally new solutions
3. The jiweiliu deletion cascade and grid-based initialization are the most promising approaches
4. DO NOT give up - the target IS achievable with the right techniques
