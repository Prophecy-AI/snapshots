## Current Status
- Best CV score: 70.615102 from exp_001 (valid baseline)
- Best LB score: 70.615102 (confirmed match)
- Target: 68.880887 | Gap to target: 1.73 points (2.5%)

## CRITICAL ISSUE RESOLVED: exp_007 FAILED DUE TO NaN VALUES

The previous submission (exp_007_ensemble_fractional) failed with "Evaluation metric raised an unexpected error" because:
- N=24 solution had `snan` (NaN) values in the x column
- The "experiments" source that contributed N=24 had corrupted data

**FIX:** The baseline (70.615102) has been restored. Always validate for NaN values before submission!

## Submission Log
| Exp | Approach | CV | LB | Notes |
|-----|----------|----|----|-------|
| 000 | baseline ensemble | 70.523 | FAILED | Overlapping trees |
| 001 | valid baseline | 70.615 | 70.615 | ✅ Reference |
| 002 | backward propagation | 70.615 | 70.615 | No improvement |
| 007 | ensemble fractional | 70.266 | FAILED | NaN in N=24 |

## KEY FINDINGS FROM THIS LOOP

### 1. Ensemble Scanning Exhausted
- Scanned 2,347 CSV files from all snapshots
- Only 0.002 improvement possible (66 valid improvements)
- **2,955 improvements REJECTED due to overlapping trees**
- The baseline is at an EXTREMELY strong local optimum

### 2. Why Most "Better" Solutions Fail
- They have overlapping trees that Kaggle rejects
- Valid solutions cluster around ~70.6
- The optimization landscape has many invalid local optima

### 3. Top Kernels Use C++ (bbox3)
- We cannot use C++ optimizers directly
- Need Python implementations of similar algorithms

## NEXT EXPERIMENT: FRACTIONAL TRANSLATION

Implement fractional translation - tiny position adjustments that find improvements SA misses:

```python
# experiments/009_fractional_translation/

import numpy as np
from shapely.geometry import Polygon

# Load baseline solution
baseline = load_baseline()

# Fractional steps to try
frac_steps = [0.001, 0.0005, 0.0002, 0.0001, 0.00005, 0.00002, 0.00001]
directions = [(0,1), (0,-1), (1,0), (-1,0), (1,1), (1,-1), (-1,1), (-1,-1)]

improvements = []
for n in range(1, 201):
    trees = baseline[n].copy()
    improved = False
    
    for tree_idx in range(n):
        for step in frac_steps:
            for dx, dy in directions:
                # Try moving tree
                new_trees = trees.copy()
                new_trees[tree_idx, 0] += dx * step
                new_trees[tree_idx, 1] += dy * step
                
                # Check validity and score
                if no_overlaps(new_trees) and score(new_trees) < score(trees):
                    trees = new_trees
                    improved = True
                    print(f"N={n}: Improved by {score(trees) - score(new_trees):.9f}")
    
    if improved:
        improvements.append(n)
        baseline[n] = trees

print(f"Improved {len(improvements)} N values")
```

## VALIDATION REQUIREMENTS (CRITICAL!)

Before ANY submission:
1. Check for NaN values in x, y, deg columns
2. Verify each N has exactly N trees
3. Check for overlapping trees using Shapely
4. Ensure 's' prefix on all numeric values
5. Verify 20,100 total rows

```python
def validate_submission(df):
    # Check for NaN
    for col in ['x', 'y', 'deg']:
        vals = df[col].astype(str).str.replace('s', '', regex=False).astype(float)
        if vals.isna().any():
            raise ValueError(f"NaN values in {col}")
    
    # Check N counts
    for n in range(1, 201):
        count = len(df[df['id'].str.startswith(f'{n:03d}_')])
        if count != n:
            raise ValueError(f"N={n} has {count} trees, expected {n}")
    
    # Check total rows
    if len(df) != 20100:
        raise ValueError(f"Expected 20100 rows, got {len(df)}")
    
    return True
```

## SUBMIT STRATEGY

1. Implement fractional translation
2. Validate thoroughly before submission
3. Submit even small improvements (we have 97 submissions left)
4. Track per-N improvements for future ensembling

## ⛔ FORBIDDEN
- Running bbox3, sa_fast, or any binary optimizer
- Submitting without NaN validation
- Submitting solutions with overlapping trees
- Using low-precision coordinates (need 15+ decimal places)