## Current Status
- **Best CV score**: 70.3295 (exp_017)
- **Best LB score**: 70.3295 (CONFIRMED - CV-LB gap = 0.0000!)
- **Target**: 68.876781
- **Gap to target**: 1.45 points (2.1%)
- **Submissions used**: 11/100 (89 remaining - ABUNDANT!)

## Response to Evaluator

The evaluator correctly identified a **CRITICAL BUG** in exp_017's rebuild from corners implementation:

**BUG**: Used tree CENTER for distance calculation
```python
dist = max(abs(x - corner_x), abs(y - corner_y))  # WRONG!
```

**CORRECT** (from chistyakov kernel):
```python
dist = max(
    abs(tree.polygon.bounds[0] - corner_x),  # polygon minx
    abs(tree.polygon.bounds[2] - corner_x),  # polygon maxx  
    abs(tree.polygon.bounds[1] - corner_y),  # polygon miny
    abs(tree.polygon.bounds[3] - corner_y),  # polygon maxy
)
```

**Analysis shows**: A tree at center (0,0) with 45° rotation has polygon bounds extending to ±0.57, not 0! This is a significant difference (~0.5-0.7 per tree) that could cause wrong tree selection.

## Score Breakdown Analysis
- N=1: 0.66 (single tree - already optimal at 45°)
- N=2-5: 1.72
- N=6-10: 1.94
- N=11-50: 14.63
- N=51-100: 17.48
- N=101-200: 33.89 ← **LARGEST CONTRIBUTION (48% of total)**

**Key insight**: N=101-200 contributes 33.89 points (48% of total score). This is where improvements are most needed.

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY] Fix Rebuild from Corners Bug and Re-run**

Create experiment `018_rebuild_corners_fixed`:

```python
def rebuild_from_corners_fixed(large_layout, target_n, current_best_score):
    """Extract subset using POLYGON BOUNDS for distance (not tree center)."""
    if len(large_layout) <= target_n:
        return None
    
    bounds = get_layout_bounds(large_layout)
    minx, miny, maxx, maxy = bounds
    corners = [(minx, miny), (minx, maxy), (maxx, miny), (maxx, maxy)]
    
    best_subset = None
    best_score = current_best_score
    
    for corner_x, corner_y in corners:
        trees_with_dist = []
        for t in large_layout:
            # FIXED: Use polygon bounds, not tree center!
            poly = create_tree_polygon(t['x'], t['y'], t['deg'])
            b = poly.bounds  # (minx, miny, maxx, maxy)
            dist = max(
                abs(b[0] - corner_x),  # polygon minx
                abs(b[2] - corner_x),  # polygon maxx
                abs(b[1] - corner_y),  # polygon miny
                abs(b[3] - corner_y),  # polygon maxy
            )
            trees_with_dist.append((dist, t))
        
        trees_with_dist.sort(key=lambda x: x[0])
        subset = [t for _, t in trees_with_dist[:target_n]]
        
        score = get_score(subset, target_n)
        if score < best_score - 1e-9:
            if validate_no_overlap_strict(subset):
                best_score = score
                best_subset = subset
    
    return (best_subset, best_score) if best_subset else None
```

### 2. **[HIGH PRIORITY] Download Missing Kaggle Datasets**

The jonathanchan kernel uses 19 sources. We're missing several:
- `santa2025-ver2`
- `santa25-simulated-annealing-with-translations`
- `72-71-santa-2025-jit-parallel-sa-c`
- `decent-starting-solution`

Each new source could contribute better solutions for specific N values.

### 3. **[MEDIUM PRIORITY] Implement C++ Optimizer from jonathanchan Kernel**

The jonathanchan kernel includes a C++ optimizer (sa_v3) with:
- Population-based optimization (keeps top 3 solutions)
- Perturbation to escape local optima
- Fractional translation refinement
- Different parameters for different N ranges

## What NOT to Try
- ❌ More simulated annealing variations (already failed multiple times)
- ❌ More snapshot mining (exhausted - only 0.000042 improvement from 3781 snapshots)
- ❌ Running bbox3/sa_fast binaries (produces same ~70.6 score)

## Validation Notes
- CV-LB alignment is PERFECT (gap = 0.0000)
- All N values pass strict 1e18 validation
- Overlap detection is working correctly

## SUBMISSION STRATEGY
- **Remaining submissions**: 89 (ABUNDANT!)
- **Submit after this experiment?**: YES - always submit to get LB feedback

## Experiment Plan for exp_018

1. **Fix the rebuild from corners bug** using polygon bounds instead of tree center
2. **Re-run on all large layouts** (N=50, 60, ..., 200)
3. **Track per-N improvements** separately
4. **Submit regardless of result** to verify CV-LB alignment continues

If this doesn't work, next experiment should focus on downloading missing datasets.