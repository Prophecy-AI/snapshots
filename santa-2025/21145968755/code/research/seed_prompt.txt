## Current Status
- Best CV score: 70.659959 from exp_000 (saspav baseline)
- Best LB score: 70.659959 (confirmed from exp_000 and exp_003)
- Target: 68.919154 | Gap to target: 1.740805 (2.5%)
- Submissions used: 3/100 (97 remaining)

## Critical Situation Assessment

**We are STUCK at a local optimum.** After 8 experiments, ALL local optimization approaches show 0 or marginal improvement:
- exp_001: C++ SA optimizer = 0 improvement
- exp_005: Valid ensemble = 0 improvement  
- exp_006: Eazy optimizer = 0.000015 improvement (FAILED on Kaggle with overlaps)
- exp_007: Rotation optimization = 0 improvement
- bbox3 optimizer test: 0.0000006 improvement

**The saspav baseline is at an extremely strong local optimum.** Local optimization CANNOT close the 1.74 point gap.

## Response to Evaluator

The evaluator correctly identified that:
1. **Local optimization is exhausted** - 8 experiments confirm this
2. **Overlap detection mismatch** - Eazy optimizer passed local validation but failed on Kaggle
3. **bbox3 optimizer NOT fully utilized** - We tested it briefly but need longer runs with multiple seeds

I agree with the evaluator's assessment. The current trajectory of "apply local optimization to saspav baseline" is EXHAUSTED. We need a fundamentally different approach.

## CRITICAL OVERLAP WARNING

**ANY optimization that modifies tree positions risks introducing precision-level overlaps that pass local Shapely validation but fail on Kaggle.**

The Eazy optimizer (exp_006) failed with "Overlapping trees in group 069" despite passing local validation. This means:
1. Kaggle uses stricter overlap detection (likely SAT-based with higher precision)
2. Local Shapely validation is INSUFFICIENT
3. We need overlap repair mechanism OR stricter local validation

**Solution**: After ANY optimization:
1. Use overlap repair with donor solution (saspav baseline) - replace any N with overlaps using baseline
2. OR use stricter local overlap detection (buffer polygons by 1e-9)
3. OR only keep configurations that are IDENTICAL to baseline

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY] Multi-Seed bbox3 Ensemble with Overlap Repair**
Run bbox3 optimizer with MANY different random seeds (10-20 runs) for longer duration (5-10 minutes each). Then:
1. Ensemble by picking best per-N from all runs
2. Apply overlap repair: for any N with overlaps, revert to saspav baseline
3. Validate with strict overlap detection before submission

**Rationale**: Different random seeds may find different local optima. Ensembling across seeds can combine the best of each. Overlap repair ensures valid submission.

**Implementation**:
```python
# Run bbox3 with different seeds
for seed in range(10):
    ./bbox3 -n 2000 -r 90  # 5-10 min per run, different random state
# Ensemble: pick best per-N from all runs
# Overlap repair: for any N with overlaps, use saspav baseline
```

### 2. **[HIGH PRIORITY] Rebuild from Corners (Chistyakov Approach)**
The chistyakov kernel "new-simple-fix-rebuild-large-layout-from-corners" shows that larger N configurations can be used to improve smaller N configurations.

**Rationale**: If N=111 has a good packing, we can extract subsets of trees from corners to potentially improve N=1 to N=110.

### 3. **[MEDIUM PRIORITY] Longer Optimization Runs**
Run bbox3 for 30+ minutes on the full configuration with overlap repair.

## What NOT to Try
- ❌ More rotation optimization (already confirmed 0 improvement)
- ❌ Simple lattice construction (88.33 score, much worse)
- ❌ Eazy optimizer without overlap repair (fails on Kaggle)
- ❌ Single-seed short optimization runs (already exhausted)
- ❌ Any optimization without overlap repair mechanism

## Submission Strategy
- Remaining submissions: 97
- Submit after EVERY experiment that produces a VALID improvement
- We have abundant submissions - use them for LB feedback
- ALWAYS validate for overlaps before submission

## Validation Notes
- CV scheme: Compute total score = Σ(side²/N) for N=1 to 200
- Overlap check: Use Shapely with buffer(1e-9) for stricter detection
- Overlap repair: Replace any N with overlaps using saspav baseline
- Always verify submission matches expected format (id, x, y, deg with 's' prefix)

## Next Experiment: Multi-Seed bbox3 Ensemble with Overlap Repair

**Objective**: Run bbox3 with 10+ different random seeds, then ensemble by picking best per-N, with overlap repair.

**Steps**:
1. Create experiment folder: experiments/009_multiseed_bbox3
2. Run bbox3 with seeds 0-9, each for 5 minutes (or until timeout)
3. Collect all output CSVs
4. Ensemble: for each N, pick the configuration with lowest score
5. Overlap repair: for any N with overlaps, use saspav baseline
6. Validate: check for overlaps with strict detection
7. If valid and improved, save as submission candidate

**Expected outcome**: 0.01-0.1 improvement (enough to make progress)

**If this fails**: Try the rebuild-from-corners approach next.

## Key Files
- Baseline: /home/code/external_data/saspav/santa-2025.csv (score 70.659959)
- bbox3 binary: /home/code/experiments/009_bbox3_optimizer/bbox3
- bbox3 source: /home/code/experiments/009_bbox3_optimizer/bbox3.cpp