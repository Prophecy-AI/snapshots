# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.659959 from exp_000 (baseline)
- Best LB score: 70.659959 (verified)
- Target: 68.919154 | Gap to target: 1.740805 (2.46%)
- Submissions used: 1/100 (94 remaining)

## Critical Finding from Loop 4 Analysis
**Comprehensive scan of 37 CSV files shows the best single source (saspav santa-2025.csv) already wins for 193/200 N values.** Ensemble from all available sources provides ZERO improvement. This means:
1. All publicly available pre-optimized solutions converge to the same local optimum
2. The gap to target (1.74 points) cannot be closed by ensembling existing solutions
3. We need to GENERATE better solutions, not just combine existing ones

## Response to Evaluator
The evaluator correctly identified that we hadn't explored all available sources. I've now done a comprehensive scan of 37 CSV files across all directories. The result confirms that the current best (70.659959) is already the best available from public sources - ensembling provides no improvement.

**Key insight**: The lattice approach (exp_004) confirmed that constructive approaches from scratch cannot match the pre-optimized baseline. Even with heavy SA optimization (30k iterations, 10 restarts), lattice only achieved 85.93 vs baseline 70.66.

**The path forward is NOT more ensembling or lattice construction. We need to apply sophisticated optimization techniques to the existing baseline.**

## What We Know Works (from top kernels)
1. **bbox3 C++ optimizer** - Uses complex number geometry, SA, fluid dynamics, hinge pivot, density gradient flow
2. **fix_direction rotation optimization** - Tightens bounding box by finding optimal rotation angle
3. **Eazy optimizer** - Uses square potential gradient, elastic pulse, complex orbital moves
4. **Multi-phase optimization** - Phase A (short runs), Phase B (medium), Phase C (long)
5. **Fractional translation** - Steps from 0.001 down to 0.00001 for fine-tuning

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Run bbox3 with Extended Time Budget
The bbox3 optimizer is the most sophisticated available. Previous experiments only ran SA for short periods. We need to:
- Run bbox3 for 3+ hours with multi-phase approach
- Use the best-keeping strategy (revert on regressions)
- Apply fix_direction after each phase

**Implementation**: Use the yongsukprasertsuk kernel's approach with extended time budget.

### 2. **[HIGH PRIORITY]** Apply Eazy Optimizer Techniques
The Eazy optimizer uses novel techniques not in our current toolset:
- Square potential gradient (pushes polygons toward center)
- Elastic pulse (periodic squeeze and relax)
- Complex orbital moves (rotation in complex plane)

**Implementation**: Compile and run eazy.cpp on the baseline.

### 3. **[MEDIUM PRIORITY]** Per-N Targeted Optimization
Analysis shows N=1 has worst efficiency (0.66). Focus optimization on specific N values:
- N=1: Current score 0.661250, theoretical best ~0.33
- N=2-10: Low efficiency, room for improvement
- Run extended SA on these specific N values

### 4. **[EXPERIMENTAL]** Genetic Algorithm Approach
Since SA is stuck at local optimum, try fundamentally different optimization:
- Population of solutions with crossover and mutation
- Fitness = bounding box area
- May find different basins of attraction

## What NOT to Try
- ❌ More lattice construction (confirmed 15+ points worse than baseline)
- ❌ More ensembling of existing CSVs (no improvement possible)
- ❌ Simple SA on baseline (already at local optimum)
- ❌ Random multi-start construction (produces worse scores)

## Validation Notes
- Score is computed as sum(side^2/n) for n=1 to 200
- Lower is better
- Verify no overlaps before submission
- Use fix_direction to tighten bounding box

## SUBMISSION STRATEGY
- Remaining submissions: 94
- **Submit after EVERY experiment** - LB feedback is valuable
- We have abundant submissions, use them to calibrate CV-LB relationship

## Key Files
- Best baseline: `/home/code/external_data/saspav/santa-2025.csv` (70.659959)
- C++ SA optimizer: `/home/code/experiments/002_cpp_optimizer/sa_v1_parallel`
- bbox3 binary: `/home/nonroot/snapshots/santa-2025/21116303805/code/preoptimized/bbox3`

## Next Experiment: exp_005_bbox3_extended
Run bbox3 optimizer with extended time budget (30+ minutes) on the baseline:
1. Copy baseline to working directory
2. Run bbox3 with -n 5000 -r 100 (more iterations, more restarts)
3. Apply fix_direction rotation optimization
4. Verify no overlaps
5. Compare to baseline and submit if improved
