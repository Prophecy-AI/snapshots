# Santa 2025 - Christmas Tree Packing Challenge - Loop 2

## Current Status
- Best CV score: 70.676102 from exp_000 (000_baseline)
- Best LB score: N/A (no submissions yet)
- Target: 68.890873 (lower is better)
- Gap to target: 1.785 points (2.59%)

## ⚠️ CRITICAL: BETTER BASELINE AVAILABLE!
The evaluator correctly identified that a better baseline exists:
- **Current baseline**: 70.676102
- **Better baseline found**: 70.627569 (snapshot 21329069570)
- **Free improvement**: 0.049 points

**FIRST PRIORITY**: Update to the better baseline before any other work!

## Response to Evaluator
The evaluator raised several valid points:

1. **Suboptimal Baseline Selection** - AGREED. The executor found 70.627569 in snapshot 21329069570 which is 0.049 points better. This must be used as the new baseline.

2. **No Code Infrastructure** - AGREED. We need reusable utilities for:
   - ChristmasTree class with correct 15-vertex geometry
   - Score calculation
   - Overlap validation
   - Submission I/O

3. **Per-N Analysis Not Actionable** - AGREED. We need to identify which N values have the most improvement potential.

4. **Constraint on Binaries** - NOTED. The seed prompt blocks pre-compiled binaries after baseline. We must implement algorithms from scratch.

## Public Kernel Status
- Top kernel: saspav/santa-submission (500 votes) - Uses bbox3 + shake_public binaries
- The kernel approach: Start with pre-optimized CSV, run shake_public, then bbox3, fix overlaps
- **Key insight**: The binaries are already at local optima - running them more won't help

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Update Baseline to 70.627569
```
cp /home/nonroot/snapshots/santa-2025/21329069570/code/code/solutions/submission_70.627569.csv /home/code/experiments/001_better_baseline/submission.csv
```
Verify no overlaps, calculate score, save as new baseline.

### 2. **[HIGH PRIORITY]** Create Code Infrastructure
Create `/home/code/utils.py` with:
- ChristmasTree class (15-vertex polygon, correct geometry)
- `calculate_score(df)` function
- `check_overlaps(df, n)` function
- `load_submission(path)` and `save_submission(df, path)` functions

### 3. **[HIGH PRIORITY]** Per-N Score Analysis
For each N from 1-200:
- Calculate current score contribution (s_n² / n)
- Calculate theoretical minimum (if known)
- Identify which N values have the most room for improvement
- Focus optimization efforts on high-impact N values

### 4. **[MEDIUM PRIORITY]** Implement Python-based Optimization
Since binaries are blocked, implement from scratch:
- **Jostle Algorithm**: Move trees slightly to reduce bounding box
- **Rotation Optimization**: Find optimal rotation angle for entire configuration
- **Local Search**: Small perturbations to tree positions/angles

## What NOT to Try
- ❌ Running bbox3, shake_public, or any pre-compiled binary
- ❌ Trying to improve the 70.676102 baseline (use 70.627569 instead)
- ❌ Complex algorithms before establishing better baseline

## Validation Notes
- Use Shapely with high precision for overlap detection
- Tolerance for overlap: intersection area > 1e-12 = overlap
- Score formula: Σ(s_n² / n) for n=1 to 200
- Tree has 15 vertices (not 11!)

## Submission Strategy
- Remaining submissions: 94
- **SUBMIT the better baseline (70.627569)** to get LB feedback
- We have abundant submissions - use them for calibration!
