# Santa 2025 Christmas Tree Packing - Evolved Seed Prompt (Loop 6)

## Current Status
- Best CV score: 70.676102 from exp_000 (saspav baseline)
- Best LB score: 70.676102 (verified - CV matches LB exactly!)
- Target: 68.922808 | Gap to target: 1.753294 (2.48%)
- Submissions used: 2/100 (98 remaining - ABUNDANT!)

## CV-LB Relationship Analysis
- CV = LB exactly (70.676102 = 70.676102398091)
- This is an optimization problem, not ML prediction
- Any CV improvement will translate directly to LB improvement
- NO distribution shift to worry about!

## What We've Learned (6 Experiments, All Same Score)
1. **Lattice-based SA DOES NOT WORK** - Produces worse scores than baseline
2. **Backward propagation shows 0 improvements** - Baseline is already optimal for this
3. **C++ tree_packer_v18 shows 0 improvements** - Ran for only 85s though
4. **The saspav solution is at a strong local optimum** - Cannot be improved by simple local search

## Response to Evaluator
The evaluator correctly identified that:
1. Lattice-based SA is the WRONG approach - the saspav solution uses a different packing strategy
2. We need to understand what makes saspav solution good before trying to improve it
3. The target (68.922808) is 2.5% better than best public - significant gap

**Key insight from evaluator**: The saspav solution is NOT a simple lattice packing. It uses custom configurations for each N. Our lattice approach generates fundamentally different (and worse) configurations.

## CRITICAL PIVOT REQUIRED

### STOP DOING:
- ❌ Lattice-based SA (produces worse results)
- ❌ Generating new solutions from scratch
- ❌ Short optimization runs (85s is not enough)

### START DOING:
- ✅ Implement the seshurajup C++ optimizer (sa_v3 + ls_v3 + fractional_translation)
- ✅ Run MUCH LONGER optimization (30+ minutes, not 85 seconds)
- ✅ Focus on per-N optimization with different parameters for different N ranges
- ✅ Try multiple restarts with population selection

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Implement seshurajup C++ Optimizer
The seshurajup kernel (71.78 score) uses a sophisticated approach:
- **sa_v3**: SA with T0=1.0, T_min=0.000005, alpha=0.25, max_angle=70.0
- **ls_v3**: Local search with 300 iterations
- **fractional_translation**: Fine position adjustments (120-150 iterations)
- **Multi-restart**: 80 restarts per N with population selection
- **Per-N parameters**: Different iterations for small/medium/large N

Key code from their kernel:
```cpp
Cfg opt_v3(Cfg c, int nr, int si) {
    // Multi-restart with population selection
    vector<pair<double, Cfg>> pop;
    for (int r = 0; r < nr; r++) {
        Cfg o = sa_v3(start, si, 1.0, 0.000005, 0.25, 70.0, seed);
        o = ls_v3(o, 300);
        o = fractional_translation(o, 150);
        // Keep best 3 in population
    }
    return best;
}
```

### 2. **[HIGH PRIORITY]** Run Longer C++ Optimization
The tree_packer_v18 ran for only 85s with 15000 iterations.
Try: `./tree_packer_v18 -n 1000000 -r 100` (10x longer)
Or compile and run the seshurajup optimizer for 30+ minutes.

### 3. **[MEDIUM PRIORITY]** Focus on Low-Efficiency N Values
Analysis shows:
- N=1: 52.9% efficiency (score 0.661) - MOST room for improvement
- N=2: 77.6% efficiency (score 0.451)
- N=3-10: 80-93% efficiency
- Large N (101-200): 48.1% of total score

Small N values have the lowest efficiency and may have room for manual optimization.

### 4. **[EXPERIMENTAL]** Try Different Starting Solutions
We have multiple solutions available:
- santa-2025.csv: 70.676102 (best)
- smartmanoj_submission.csv: 70.743774
- submission_70_926149550346.csv: 70.926150

Try optimizing from different starting points - they may have different local optima.

## What NOT to Try
- ❌ Lattice-based SA (6 experiments proved it doesn't work)
- ❌ Backward propagation (already optimal)
- ❌ Short optimization runs (<5 minutes)
- ❌ Generating solutions from scratch

## Validation Notes
- CV = LB exactly (verified with submission)
- Score calculation is correct (matches Kaggle)
- No overlaps in baseline solution

## SUBMISSION STRATEGY
- Remaining submissions: 98 (ABUNDANT!)
- Submit after EVERY experiment that produces a valid submission
- LB feedback is FREE information - use it!
- Even small improvements should be submitted to track progress

## Technical Notes
- The seshurajup C++ optimizer is in: `/home/code/research/kernels/seshurajup_71-78-jit-parallel-sa-c-tpu-96-cores/`
- Baseline solution: `/home/code/santa-2025-csv/santa-2025.csv`
- bbox3 optimizer: `/home/code/santa-2025-csv/bbox3`
- tree_packer_v18: `/home/code/tree_packer_v18`

## Key Insight
The target of 68.922808 requires ~2.5% improvement. This is NOT achievable through:
- Minor parameter tweaks
- Short optimization runs
- Lattice-based approaches

It REQUIRES:
- Sophisticated multi-phase optimization (SA + local search + fractional translation)
- Long optimization runs (30+ minutes)
- Per-N customization
- Multiple restarts with population selection

The seshurajup kernel shows this is possible - implement their approach!