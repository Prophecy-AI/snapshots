# Santa 2025 - Christmas Tree Packing Challenge - Loop 28 Strategy

## Current Status
- Best CV score: 70.624381 from exp_026 (026_snapshot_ensemble)
- Best LB score: 70.626088 (exp_024, confirmed)
- Target: 68.919154 | Gap to target: 1.705 points (2.47%)
- Submissions used: 10/100 (90 remaining)

## CRITICAL DISCOVERY
According to web search, the current public LB leader is terry_u16 with score **71.191427**.
Our best LB score is **70.626088**, which is **BETTER than the current leader by 0.565 points!**

This suggests one of:
1. The web search leaderboard data may be outdated
2. The target of 68.919 may be from a different competition phase or metric
3. We may already be in a winning position!

**IMMEDIATE ACTION**: Submit our current best (70.624381) to verify our standing on the leaderboard.

## Response to Evaluator
The evaluator correctly identified:
1. **All optimization approaches have been exhausted** - Confirmed after 29 experiments
2. **SparroWASM workflow not systematically applied** - This is a valid unexplored approach
3. **The baseline is at an EXTREMELY STRONG LOCAL OPTIMUM** - Confirmed

I AGREE with the evaluator's assessment. However, the critical discovery that our score may already beat the LB leader changes the priority.

## Experiment History Summary (29 experiments)
- **Baseline**: 70.647327 (exp_000)
- **Current best**: 70.624381 (exp_026)
- **Total improvement**: 0.023 points over 29 experiments

### What's Been Tried (ALL FAILED to improve beyond 70.624):
1. ❌ bbox3 optimization - produces overlapping trees
2. ❌ SA optimization (Python and C++) - converges to same local optimum
3. ❌ Random restart SA - random configs are worse
4. ❌ Basin hopping - no improvement
5. ❌ Gradient descent - zero gradient at local minimum
6. ❌ Iterative SA + guided refinement - no improvement
7. ❌ Asymmetric perturbations + SA - no improvement
8. ❌ Grid-based initial solutions (zaburo) - 25% worse than baseline
9. ❌ Asymmetric configurations from scratch - ALL worse than baseline
10. ❌ Greedy beam search (exp_029) - ALL worse than baseline

### What's Worked (PARTIAL SUCCESS):
1. ✓ Ensemble from multiple sources - 0.017 improvement (exp_009)
2. ✓ Snapshot ensemble - 0.003 improvement (exp_022)
3. ✓ Deletion cascade - 0.0015 improvement (exp_025)

**KEY INSIGHT**: The ONLY approaches that yielded ANY improvement are ensemble methods combining solutions from DIFFERENT SOURCES.

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Submit Current Best to LB
Submit exp_026 (70.624381) to verify:
- Our score is accurate
- We are actually beating the LB leader
- No validation issues

### 2. **[HIGH PRIORITY]** Implement SparroWASM Workflow
The sacuscreed kernel shows the complete workflow for using SparroWASM:

```python
# Step 1: Export tree shape to JSON
data = {
  "name": "ChristmasTree",
  "items": [{
    "id": 0,
    "demand": N,  # Number of trees
    "shape": {
      "type": "simple_polygon",
      "data": [
        [0.0, 0.8], [0.125, 0.5], [0.0625, 0.5],
        [0.2, 0.25], [0.1, 0.25], [0.35, 0.0],
        [0.075, 0.0], [0.075, -0.2], [-0.075, -0.2],
        [-0.075, 0.0], [-0.35, 0.0], [-0.1, 0.25],
        [-0.2, 0.25], [-0.0625, 0.5], [-0.125, 0.5]
      ]
    }
  }],
  "strip_height": S  # Current best side length (or slightly smaller)
}
```

Step 2: Run SparroWASM at https://jeroengar.github.io/sparroWASM/
Step 3: Parse SVG output to extract tree positions
Step 4: Validate with Shapely and compare to baseline

**Focus on N=1-20 first** where improvements have highest leverage.

### 3. **[MEDIUM PRIORITY]** Search for More Public Solutions
The ensemble approach has been the ONLY successful strategy. Look for:
- New Kaggle kernels with different solutions
- Kaggle datasets with pre-computed solutions

## What NOT to Try
- ❌ More SA/bbox3 iterations (proven ineffective - 29 experiments)
- ❌ Constructive heuristics from scratch (beam search failed)
- ❌ Grid-based approaches (zaburo was 25% worse)
- ❌ Any variation of local search (all converge to same optimum)

## SUBMISSION STRATEGY
- Remaining submissions: 90
- Submit after this experiment? **YES** - we need to verify our LB standing
- If our score beats the LB leader, we may already be in a winning position!

## Score Breakdown by N Range
- N=1-10: 4.33 points (6.1%)
- N=11-20: 3.72 points (5.3%)
- N=21-50: 10.98 points (15.5%)
- N=51-100: 17.61 points (24.9%)
- N=101-150: 17.14 points (24.3%)
- N=151-200: 16.84 points (23.8%)

## Technical Notes
- CV and LB scores match perfectly (deterministic optimization problem)
- All 85 snapshots have been exhausted - no better valid solutions found
- The baseline is at an extremely strong local optimum

## Key Questions to Answer
1. Is our score of 70.624 actually better than the LB leader?
2. What is the actual target score for this competition?
3. Can SparroWASM find better configurations for small N?
