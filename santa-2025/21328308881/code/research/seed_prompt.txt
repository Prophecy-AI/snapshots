# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.6761 from exp_000 (baseline)
- Best LB score: 70.6761 (confirmed - CV=LB gap is 0.0000)
- Target: 68.894234 | Gap to target: 1.78 points (2.6%)

## Public Kernel Status
- **Baseline established**: santa-2025.csv at 70.6761
- **Top kernels identified**: 
  - saspav/santa-submission (497 votes) - uses bbox3 + shake_public
  - smartmanoj/santa-claude (378 votes) - tree_packer_v21.cpp
  - yongsukprasertsuk/santa-2025-best-keeping-bbox3-runner (369 votes) - phased bbox3 optimization
  - jazivxt/why-not (352 votes) - bbox3.cpp source
  - jonathanchan/santa25-ensemble-sa-fractional-translation (176 votes) - ensemble + SA + fractional translation

## CRITICAL FINDINGS FROM PREVIOUS RUNS
1. **Ensemble provides ZERO improvement** - santa-2025.csv dominates all 200 N values across 30 CSVs
2. **N=1 is already at theoretical minimum** - 45 degrees, score 0.661250
3. **Short optimization runs find NO improvements** - the local optimum is too tight
4. **Backward propagation found NO improvements** - larger N configs don't have better sub-configs
5. **12 experiments with SA/C++ optimizer = ALL SAME SCORE** - pre-optimized baseline is at local optimum

## CV-LB Relationship
- CV = LB (perfect correlation - this is a pure optimization problem)
- No distribution shift to worry about
- Any CV improvement will translate directly to LB improvement

## Response to Evaluator
The evaluator correctly identified:
1. **Ensemble opportunity was explored** - but santa-2025.csv dominates all N values (CONFIRMED)
2. **N=1 is already optimal** - 45 degrees is the theoretical minimum (CONFIRMED)
3. **bbox3 not yet used with extended runs** - THIS IS THE KEY OPPORTUNITY
4. **Lattice-based approach not explored** - THIS IS ANOTHER KEY OPPORTUNITY

The evaluator's key insight: "The gap of 1.78 points requires fundamentally different approaches - not micro-optimization."

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Run bbox3 with EXTENDED parameters (hours, not minutes)
The top kernels run optimization for HOURS with high iterations:
```bash
./bbox3 -n 100000 -r 512  # Run for 10+ hours
```
The yongsukprasertsuk kernel shows a phased approach:
- Phase A: Short runs (2 min) to find promising (n, r) combinations
- Phase B: Medium runs (10 min) on top candidates
- Phase C: Long runs (20 min) on best few

**Implementation:**
1. Copy bbox3 binary from preoptimized folder
2. Run with extended parameters: `-n 50000 -r 256` (start with this)
3. Apply fix_direction post-processing
4. Validate for overlaps
5. Submit if improved

### 2. **[HIGH PRIORITY]** Implement Lattice/Grid-Based Approach for Large N (N >= 58)
The egortrushin kernel uses a fundamentally different approach:
- Start with 2 base trees in specific configuration
- Translate them in x and y directions to create grid pattern
- For N=144, 156, 196, 200, this can achieve tighter bounds

### 3. **[MEDIUM PRIORITY]** Try Different Starting Configurations
Instead of optimizing the pre-optimized submission:
- Generate new random configurations
- Use lattice-based initial placement
- Try different angle distributions

## What NOT to Try (CONFIRMED DEAD ENDS)
- ❌ Simple ensemble (santa-2025.csv dominates all N values)
- ❌ Short optimization runs (local optimum is too tight)
- ❌ Backward propagation (no improvements found)
- ❌ Micro-optimization (gap is too large)
- ❌ N=1 optimization (already at theoretical minimum)

## SUBMISSION STRATEGY
- Remaining submissions: 99
- **SUBMIT AGGRESSIVELY** - we have abundant submissions
- Submit after EVERY experiment to get LB feedback
- Even small improvements are valuable data points

## Validation Notes
- CV = LB for this optimization problem
- Must validate for overlaps before submitting
- Use high-precision Decimal arithmetic

## Technical Resources
- bbox3 binary: `/home/nonroot/snapshots/santa-2025/21116303805/code/preoptimized/bbox3`
- Pre-optimized CSV: `/home/nonroot/snapshots/santa-2025/21116303805/code/preoptimized/santa-2025.csv`
- Kernel code: `/home/code/research/kernels/`

## NEXT EXPERIMENT: 002_bbox3_extended
1. Copy bbox3 binary and santa-2025.csv to experiment folder
2. Run bbox3 with extended parameters: `-n 20000 -r 128` (start moderate, can increase)
3. Apply fix_direction post-processing
4. Validate for overlaps
5. Calculate score
6. Submit to get LB feedback