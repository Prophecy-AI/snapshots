# Santa 2025 - Evolved Strategy (Loop 1)

## Current Status
- Best CV score: 150.674245 from exp_000 (001_baseline)
- Best LB score: N/A (no submissions yet)
- Target: 68.922808 | Gap to target: 81.75 points

## CRITICAL DISCOVERY: Pre-optimized Submissions Available!

The evaluator was CORRECT. We started from the wrong place.

**Pre-optimized submission scores (verified locally):**
- bucket-of-chump: 70.676501
- santa-2025.csv: 70.676102 (BEST)
- chistyakov: 70.926150
- telegram 71.97: 71.972027

**The gap from pre-optimized (70.68) to target (68.92) is only 1.75 points!**

This is a tractable problem. We need to:
1. Start from santa-2025.csv (score 70.68)
2. Apply advanced optimization techniques
3. Close the 1.75 point gap

## Response to Evaluator

The evaluator correctly identified the critical issue: we started from sample_submission.csv (173.65) instead of pre-optimized datasets (~70.68). This was a ~103 point gap that we could never close with simple optimization.

**Action taken:** Downloaded pre-optimized datasets to `/home/code/preoptimized/`:
- `santa-2025.csv` (score 70.676102) - BEST starting point
- `submission.csv` (bucket-of-chump, score 70.676501)
- `bbox3` (pre-compiled optimizer binary)

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Use Pre-optimized Starting Point
Start from `/home/code/preoptimized/santa-2025.csv` which scores 70.68.

### 2. **[HIGH PRIORITY]** Run Extended bbox3 Optimization
Use the pre-compiled bbox3 binary from the datasets:
```bash
chmod +x /home/code/preoptimized/bbox3
cp /home/code/preoptimized/santa-2025.csv submission.csv
./preoptimized/bbox3 -n 20000 -r 128
```

### 3. **[HIGH PRIORITY]** Implement Fractional Translation Optimization
From the jonathanchan kernel, the key technique is **fractional translation**:
```cpp
double frac_steps[] = {0.001, 0.0005, 0.0002, 0.0001, 0.00005, 0.00002, 0.00001};
// For each tree, try moving in 8 directions by these tiny amounts
// Keep changes that reduce bounding box without causing overlap
```

### 4. **[MEDIUM PRIORITY]** Implement fix_direction Post-Processing
After each optimization pass, apply rotation optimization to minimize bounding box.

### 5. **[MEDIUM PRIORITY]** Ensemble Multiple Sources
For each N, keep the best configuration from multiple sources.

### 6. **[LOWER PRIORITY]** Backward Propagation
After getting close to target, implement bp.cpp to improve smaller N.

## What NOT to Try
- Starting from sample_submission.csv (score 173.65) - too far from target
- Simple greedy placement - already done by sample submission
- Pure RL approaches - not competitive for this problem

## Validation Notes
- Score = Σ(s_n² / n) for n=1 to 200
- No overlapping trees allowed
- All coordinates must be in [-100, 100]
- Values must be prefixed with 's' in submission

## SUBMISSION STRATEGY
- Remaining submissions: 94
- **SUBMIT after this experiment** - we need LB feedback to calibrate
- The pre-optimized starting point should give us ~70.68 on LB
- Then we can measure improvement from optimization

## Expected Outcome
Starting from 70.68, with extended optimization we should be able to:
1. First submission: ~70.5-70.7 (verify baseline)
2. With extended bbox3 + fix_direction: ~70.0-70.3
3. With fractional translation: ~69.5-70.0
4. Target: 68.92 (achievable with multiple optimization passes)

## Key Files
- Pre-optimized starting point: `/home/code/preoptimized/santa-2025.csv`
- Pre-compiled bbox3: `/home/code/preoptimized/bbox3`
- Ensemble CSV: `/home/code/preoptimized/ensemble.csv`

## Experiment Plan for Next Loop
1. Copy santa-2025.csv as starting point
2. Run bbox3 with -n 20000 -r 128 (extended optimization)
3. Apply fix_direction post-processing
4. Validate no overlaps
5. Score and submit to get LB feedback
6. If score improves, continue with fractional translation