# Christmas Tree Packing Optimization - Seed Prompt (Loop 6)

## Current Status
- Best CV score: 70.679449 (ensemble from all CSVs)
- Best LB score: 70.682741 (exp_002)
- Target: 68.922808
- Gap to target: 1.756641 points (2.5%)

## Public Kernel Status (CRITICAL!)
- Have we implemented the best kernel yet? YES - we have the pre-optimized baselines
- Top kernels identified: jazivxt/why-not (uses bucket-of-chump), saspav/santa-submission (uses santa-2025-csv)
- Kernels we've implemented: All pre-optimized baselines from external datasets
- **CRITICAL FINDING**: All external CSVs have overlaps (11-12 N values each). Only overlap-free configurations can be used.

## Ensemble Strategy
- Models available for ensemble: santa-2025.csv, bucket-of-chump, best_ensemble, 71.97.csv, submission_70_926149550346.csv, chistyakov/submission_best.csv
- Current ensemble score: 70.679449 (0 overlaps)
- **PROBLEM**: Ensemble only improves by 0.001555 points over current best

## CV-LB Relationship Analysis
- CV = LB for this problem (deterministic optimization, no train/test split)
- The gap is NOT due to distribution shift - it's due to the baseline being at a local optimum

## Response to Evaluator
The evaluator correctly identified that:
1. Local search methods cannot escape the local optimum
2. External datasets should be explored
3. Much longer optimization runs may be needed

I have now:
1. ✅ Explored ALL external datasets in the snapshot directory (30 CSVs)
2. ✅ Created an ensemble from all overlap-free configurations
3. ✅ Confirmed the ensemble only improves by 0.001555 points

**Key insight**: The external CSVs (bucket-of-chump, santa-2025-csv) have overlaps in 11-12 N values. The overlap-free configurations from these CSVs are already captured in our ensemble. The gap of 1.76 points cannot be closed by ensembling existing CSVs.

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Run bbox3 optimizer for MUCH longer (hours, not minutes)
- The pre-optimized baselines were created with extensive optimization (likely millions of iterations)
- Our previous runs used only thousands of iterations
- Run bbox3 with n=10000, r=1000 for each N value
- Focus on N values with highest scores (N=1-20)

### 2. **[HIGH PRIORITY]** Try different starting configurations
- The current baseline may be at a local optimum
- Generate random starting configurations and optimize from scratch
- Use genetic algorithm to evolve configurations

### 3. **[MEDIUM PRIORITY]** Implement No-Fit Polygon (NFP) based placement
- NFP is the state-of-the-art for 2D irregular polygon packing
- Can find globally optimal placements for small N
- May find better configurations than local search

### 4. **[MEDIUM PRIORITY]** Try constraint programming / MIP formulation
- Formulate the problem as a mixed-integer program
- Use commercial solvers (Gurobi, OR-Tools) to find optimal solutions
- May be computationally expensive but could find global optima

### 5. **[LOW PRIORITY]** Manual fine-tuning for specific N values
- Focus on N=1-20 which contribute most to the score
- Use interactive tools to manually adjust tree positions
- May find improvements that automated methods miss

## What NOT to Try
- More local search on the current baseline (already exhaustively tried)
- Short optimization runs (need hours, not minutes)
- Ensembling without overlap validation (introduces invalid configurations)

## Validation Notes
- CV scheme: Calculate score for all N=1-200, verify 0 overlaps with Shapely
- Score = Σ(side_length²/N) for all N from 1 to 200
- Lower is better

## Key Findings
1. All external CSVs have overlaps (11-12 N values each)
2. Ensemble from all overlap-free configurations scores 70.679449
3. Gap to target (1.76 points) requires fundamentally different approaches
4. The baseline is at a very strong local optimum that cannot be escaped with local search

## SUBMISSION STRATEGY
- Remaining submissions: 93
- Submit after this experiment? YES - we have abundant submissions
- The ensemble (70.679449) is a tiny improvement over current best (70.681004)
- Submit to verify CV = LB and get feedback
