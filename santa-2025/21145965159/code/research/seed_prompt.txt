# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.675457 from 006_corner_extraction_ensemble
- Best LB score: 70.675457 (verified - CV=LB gap is 0.0000)
- Target: 68.919154 | Gap to target: 1.756303 (2.55%)
- Submissions used: 5/100 (95 remaining)

## CV-LB Relationship Analysis
- 5 submissions made, 3 successful, 2 failed due to overlaps
- Successful submissions show PERFECT CV-LB match (gap = 0.0000)
- This confirms: scoring is accurate, the problem is escaping the local optimum

## Response to Evaluator
The evaluator correctly identified:
1. **The improvement rate is too slow** - 0.000645 per experiment, need 1.756 total
2. **Need to run bbox3 for HOURS, not minutes** - The bbox3 runner kernel runs 3 hours
3. **The why-not kernel's bbox3 has overlap repair** - global_squeeze function
4. **Small N values have the most improvement potential** - N=1 alone has 0.338 potential

I agree with all points. The next experiment MUST run long optimization (30+ minutes minimum).

## Key Findings from Analysis
1. **N=1 is the biggest opportunity**: efficiency 0.42 vs theoretical 0.86 = 0.338 improvement potential
2. **Small N values (1-10) contribute ~4 points** and have the most room for improvement
3. **The why-not kernel's bbox3.cpp compiled successfully** with OpenMP support
4. **The bbox3 runner kernel strategy**:
   - Phase A: 2-min runs with n=1000-2000, r=30-90 (15 combinations)
   - Phase B: 10-min runs on top 3 candidates
   - Phase C: 20-min runs on top 2 candidates
   - Total: 3 hours

## Recommended Approaches (Priority Order)

### 1. **[HIGHEST PRIORITY]** Run bbox3 for 30+ minutes on current best
The why-not kernel's bbox3.cpp is compiled at `/home/code/experiments/007_long_bbox3/bbox3`
- Input: `/home/code/experiments/007_long_bbox3/submission.csv` (current best 70.675457)
- Run with: `./bbox3 -n 2000 -r 60` (2000 iterations, 60 restarts)
- This should take 30-60 minutes
- After bbox3, apply fix_direction rotation optimization
- Validate no overlaps before submitting

### 2. **[HIGH PRIORITY]** Focus on small N optimization
N=1 through N=10 have the most improvement potential:
- N=1: 0.338 potential (efficiency 0.42)
- N=2: 0.128 potential (efficiency 0.62)
- N=3: 0.112 potential (efficiency 0.64)
- Total for N=1-10: ~1.0 point potential

Consider running bbox3 with focus on small N values only.

### 3. **[MEDIUM PRIORITY]** Try different initial configurations
The current solution may be at a local optimum. Try:
- Perturbing the solution before optimization
- Starting from a different pre-optimized solution
- Using the global_squeeze function to escape local optima

### 4. **[LOWER PRIORITY]** Ensemble multiple optimization runs
After running bbox3 multiple times with different parameters:
- Compare N-by-N scores across all runs
- Take the best configuration for each N
- This can combine strengths of different optimization runs

## What NOT to Try
- Short optimization runs (< 10 minutes) - already proven insufficient
- The eazy optimizer - creates overlaps that Kaggle detects but local validation misses
- Marginal ensembling without new optimization - improvement rate too slow

## Validation Notes
- Use strict overlap detection (threshold=1e-15)
- The why-not bbox3 has built-in overlap repair (global_squeeze)
- Always verify no overlaps before submitting

## SUBMISSION STRATEGY
- Remaining submissions: 95
- **SUBMIT after this experiment** - we have abundant submissions
- LB feedback is free information - USE IT!

## Technical Setup
- bbox3 binary: `/home/code/experiments/007_long_bbox3/bbox3`
- Input CSV: `/home/code/experiments/007_long_bbox3/submission.csv`
- Run command: `./bbox3 -n 2000 -r 60`
- Expected runtime: 30-60 minutes