# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.675457 from corner_extraction ensemble (overlap-free, NOT YET SUBMITTED)
- Best verified LB score: 70.676102 (ensemble.csv)
- Target: 68.919154 | Gap to target: 1.756303 points (2.55%)
- Submissions remaining: 93

## CRITICAL ISSUE IDENTIFIED
The eazy optimizer submission (exp_003, CV=70.675478) FAILED with "Overlapping trees in group 003" despite local Shapely validation showing NO overlaps. This is a **precision mismatch** between local validation and Kaggle's validation.

**Root cause**: The eazy optimizer modified tree 003_0 from (1.123656, 0.781102, 111.125°) to (1.143369, 0.819464, 112.873°), creating a tiny overlap that Kaggle detected but our Shapely validation missed.

## Response to Evaluator
The evaluator correctly identified:
1. ✅ The eazy optimizer achieved improvement (0.000624) but submission FAILED
2. ✅ The improvement rate is too slow to reach target
3. ✅ We need fundamentally different approaches

**My response**: The evaluator is right that we need to pivot. However, we have an UNTESTED overlap-free solution (corner_extraction ensemble at 70.675457) that should be submitted FIRST to establish a new baseline. Then we can try more aggressive optimization.

## Recommended Approaches (Priority Order)

### 1. **[IMMEDIATE - THIS EXPERIMENT]** Submit corner_extraction ensemble
- File: `/home/code/experiments/006_corner_extraction/ensemble_best.csv`
- Score: 70.675457 (improvement of 0.000645 over baseline)
- **VERIFIED OVERLAP-FREE** by local validation
- Copy to `/home/submission/submission.csv` and SUBMIT
- This establishes a new verified LB baseline

### 2. **[NEXT EXPERIMENT]** Try bbox3 optimizer from "why-not" kernel
The bbox3 optimizer uses different techniques than eazy:
- Complex Number Vector Coordination
- Fluid Dynamics simulation
- Hinge Pivot optimization
- Density Gradient Flow
- Global Boundary Tension

Source: `/home/code/research/kernels/jazivxt_why-not/bbox3.cpp`
Compile and run on the corner_extraction ensemble.

### 3. **[AFTER THAT]** Implement backward propagation
From the backpacking kernel (`/home/code/research/kernels/crodoc_74-75-backpacking-christmas-trees/`):
- Start from N=200 and work backward to N=1
- When smaller N has worse score than larger N, copy larger config and drop trees
- This propagates good packing patterns

### 4. **[MEDIUM PRIORITY]** Focus on small N optimization
- N=1 contributes 0.661 to score (side=0.8132)
- N=2 contributes 0.451 to score (side=0.9495)
- Small N values have more room for improvement

## What NOT to Try
- ❌ The eazy optimizer without stricter overlap validation
- ❌ Any optimizer that modifies coordinates without high-precision validation
- ❌ Submitting solutions that haven't been validated for overlaps

## Validation Requirements
Before submitting ANY solution:
1. Check for overlaps using Shapely with intersection.area > 1e-15 threshold
2. Verify the score matches expected value
3. Ensure coordinates are properly formatted

## SUBMISSION STRATEGY
- Remaining submissions: 93 (ABUNDANT!)
- **SUBMIT THE CORNER_EXTRACTION ENSEMBLE NOW**
- This is a SAFE improvement that should work on LB
- Then continue with bbox3 optimizer

## Key Files
- Corner extraction ensemble: `/home/code/experiments/006_corner_extraction/ensemble_best.csv`
- bbox3 optimizer source: `/home/code/research/kernels/jazivxt_why-not/bbox3.cpp`
- Backpacking kernel: `/home/code/research/kernels/crodoc_74-75-backpacking-christmas-trees/`

## Gap Analysis
- Current best CV: 70.675457
- Target: 68.919154
- Gap: 1.756303 (2.55%)

The gap is significant. We need to:
1. First verify the corner_extraction ensemble works on LB
2. Then try more aggressive optimization with bbox3
3. Consider fundamentally different approaches (lattice packing, backward propagation)

## Experiment to Run NOW
1. Log experiment 006_corner_extraction with CV=70.675457
2. Copy ensemble_best.csv to /home/submission/submission.csv
3. SUBMIT to verify it works on LB
4. If successful, proceed with bbox3 optimization