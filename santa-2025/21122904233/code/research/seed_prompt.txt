# Santa 2025 - Evolved Strategy (Loop 4)

## Current Status
- **Best CV**: 118.23 (Infinite Loop 5x10k)
- **Target**: 68.92
- **Gap**: ~49 points
- **Approach**: Continuous Loop: `Pack(10k) -> Rotate -> BP`

## Critical Insight: The "Infinite Loop" Works
The previous experiment (Loop 3) improved the score from 121.04 to 118.23 in just 55 minutes.
This confirms that the **iterative application of BP** is the key driver of improvement.
The `tree_packer` (C++) also has an internal BP (Phase 2), so we are effectively doing "Nested BP".

## Research Findings
1. **Cooling Schedule**: Web research suggests "Adaptive Cooling" (slow down when acceptance drops) and "Reheating" (boost temp when stalled).
   - Our "Infinite Loop" effectively implements **Reheating** because each `tree_packer` call restarts the SA process (likely resetting temperature or starting from a high temp relative to the local optimum).
2. **Simulated Quenching**: Adjusting step sizes based on success/failure.
3. **Top Kernel Strategy**: The "Best-Keeping bbox3 Runner" uses a 3-phase approach (Short -> Medium -> Long runs) to tune N/R parameters. It treats `tree_packer` as a black box.
   - **My Strategy is Better**: Instead of tuning N/R for a black box, I am running a continuous improvement loop.

## Recommended Approach: "Long Infinite Loop"
We need to run the successful "Infinite Loop" for much longer to allow it to converge further.
The score dropped by ~3 points in 1 hour. We have 100 submissions.
I will run a **4-hour** experiment.

**Enhancements:**
1. **Increase Iterations**: Bump `tree_packer` iterations to 20,000 per loop (was 10,000). This gives SA more time to cool properly in each "reheat" cycle.
2. **Adaptive Loop**: If improvement slows down, increase iterations further? No, keep it simple for now.
3. **Persistence**: Save intermediate results frequently.

## Response to Evaluator
- **Agree**: "Scale Up and Target High N". I am increasing the duration to 4 hours and iterations to 20k.
- **Agree**: "BP is the magic". The loop maximizes BP usage.
- **Action**: I will implement the 4-hour loop.

## Execution Plan
1. Create `experiments/004_long_infinite_loop`.
2. Copy `tree_packer`, `bp`, and `submission.csv` (best so far).
3. Create `run_long_loop.ipynb` (based on `run_loop.ipynb`).
   - Set duration to 14000 seconds (~3.9 hours).
   - Set `tree_packer` iterations to 20,000.
   - Set `restarts` to 16.
4. Run it.
5. Submit.
