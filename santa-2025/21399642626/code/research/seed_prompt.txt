## Current Status
- Best CV score: 70.315389 from exp_031
- Best LB score: 70.3155 (exp_029)
- Target: 68.872047 | Gap to target: 1.44 points (2.10%)

## ‚ö†Ô∏è CRITICAL: exp_030 FAILED ON KAGGLE

**Error:** Overlapping trees in group 187

The saspav external data for N=187 has overlaps that Kaggle's stricter validation catches but Shapely doesn't. **exp_029 is the ONLY known-good submission.**

## ‚õî FORBIDDEN (WILL CAUSE OVERLAP FAILURES)

- ‚ùå Using saspav santa-2025.csv for N=187 - causes overlap failure
- ‚ùå Any external data without strict validation
- ‚ùå Submitting without validating ALL N values

## ‚úÖ NEXT EXPERIMENT: Extended bbox3 Optimization (8 hours)

The evaluator correctly identified that 37 minutes of bbox3 is NOT extended optimization. Top teams run for 24-72 hours.

### Experiment 032: Extended bbox3 (8 hours)

**CRITICAL: Use exp_029 as base (known good on Kaggle)**

```bash
cd /home/code/experiments
mkdir -p 032_extended_8hr

# Copy known-good submission as input
cp /home/code/experiments/029_final_ensemble_v2/submission.csv 032_extended_8hr/input.csv

# Check bbox3 help for available options
../bbox3 --help 2>&1 || ../bbox3 -h 2>&1 || echo "No help available"

# Run bbox3 for 8 hours (28800 seconds) with maximum iterations
# Adjust flags based on what bbox3 supports
timeout 28800 ../bbox3 -n 1000000 -r 5000 -i 032_extended_8hr/input.csv -o 032_extended_8hr/output.csv
```

### Validation After Optimization

```python
from shapely.geometry import Polygon
import numpy as np
import pandas as pd

TX = [0, 0.125, 0.0625, 0.2, 0.1, 0.35, 0.075, 0.075, -0.075, -0.075, -0.35, -0.1, -0.2, -0.0625, -0.125]
TY = [0.8, 0.5, 0.5, 0.25, 0.25, 0, 0, -0.2, -0.2, 0, 0, 0.25, 0.25, 0.5, 0.5]

def validate_no_overlap(trees):
    polygons = []
    for tree in trees:
        rad = np.radians(tree['deg'])
        cos_a, sin_a = np.cos(rad), np.sin(rad)
        vertices = [(tx * cos_a - ty * sin_a + tree['x'], 
                     tx * sin_a + ty * cos_a + tree['y']) 
                    for tx, ty in zip(TX, TY)]
        polygons.append(Polygon(vertices))
    
    for i in range(len(polygons)):
        for j in range(i+1, len(polygons)):
            if polygons[i].intersects(polygons[j]) and not polygons[i].touches(polygons[j]):
                intersection = polygons[i].intersection(polygons[j])
                if intersection.area > 1e-12:
                    return False, f"Trees {i} and {j} overlap"
    return True, "OK"

# Validate ALL N values before submission
for n in range(1, 201):
    n_df = df[df['n'] == n]
    trees = n_df[['x', 'y', 'deg']].to_dict('records')
    is_valid, msg = validate_no_overlap(trees)
    if not is_valid:
        print(f"N={n}: OVERLAP - falling back to exp_029")
        # Use exp_029's solution for this N
```

### If Extended Optimization Fails

If bbox3 finds < 0.01 improvement after 8 hours:
1. The local search approach is exhausted
2. Search for NEW external data sources (check latest kernels)
3. Try completely different representation

### Submission Strategy

1. If score improves by > 0.001, submit
2. Track per-N improvements
3. Always validate before submission

## üìä Key Metrics to Track

- Total score improvement
- Number of N values improved
- Runtime
- Any overlap failures

## ‚ö†Ô∏è CRITICAL REMINDERS

1. **exp_029 is the ONLY known-good submission** - always use as base
2. **Validate ALL N values** before submission
3. **Fall back to exp_029** for any N with overlaps
4. **The gap is 1.44 points** - we need significant improvement, not micro-optimizations
