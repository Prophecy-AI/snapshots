## Current Status
- Best CV score: 70.306164 (exp_044)
- Best LB score: 70.306164 (exp_044) - CV = LB exactly (deterministic problem)
- Target: 68.861114 | Gap: 1.445 points (2.06%)
- Submissions remaining: 78

## CRITICAL SITUATION ASSESSMENT

### What We've Learned (47 experiments, 22 submissions)
1. **Baseline is at EXTREMELY strong local optimum** - CMA-ES, Basin Hopping, SA all FAILED
2. **Any perturbation causes overlaps** - Trees positioned with sub-millimeter precision
3. **bbox3_local compiles and runs** - Found 0.000001 improvement in 2 minutes
4. **fix_direction found 0 improvements** - Already rotation-optimized
5. **External data mining EXHAUSTED** - exp_040 found only 0.00001 improvement
6. **Subset extraction found 0.0016 improvement** - Only algorithmic success in 10+ experiments

### Per-N Analysis (from loop 46)
- N=1 has 0.311 room for improvement (actual 0.661 vs theoretical 0.350)
- Small N (1-20) contribute 11.4% of total but have most room
- Need 2.06% uniform improvement OR 17.98% on small N alone

### Approaches That FAILED (DO NOT REPEAT)
- ❌ CMA-ES global optimization - cannot find valid solutions
- ❌ Basin Hopping - perturbations cause overlaps
- ❌ Simulated Annealing - no improvements found
- ❌ Genetic Algorithm - no improvements found
- ❌ Constructive algorithms (lattice, BLF, row-based) - WORSE than baseline
- ❌ Cross-N hybridization - no improvements found
- ❌ External data mining - exhausted

## WHAT TOP TEAMS DO (from kernel analysis)

The "Why Not" kernel (385 votes) and "Best-Keeping bbox3 Runner" (373 votes) show:

1. **3-Phase bbox3 optimization:**
   - Phase A: 2-minute runs with n=1000-2000, r=30-90 (find promising settings)
   - Phase B: 10-minute runs on top candidates
   - Phase C: 20-minute runs on best few
   - TOTAL: 3+ hours of optimization

2. **fix_direction rotation tightening** after each bbox3 run

3. **repair_overlaps_in_place** to fix any overlaps by falling back to baseline

4. **Crystallization pattern analysis** - understanding lattice structure

## NEXT EXPERIMENT: EXTENDED bbox3 OPTIMIZATION (3+ HOURS)

### MANDATORY APPROACH

The evaluator correctly identified that we have NOT run bbox3 for extended time.
The compiled binary exists at `/home/code/experiments/bbox3_local`.

**EXPERIMENT 047: Run bbox3_local for 3+ hours with the kernel's 3-phase approach**

```python
# Phase A: Short runs to find promising (n, r) combinations
PHASE_A = {
    "timeout": 120,  # 2 minutes each
    "n_values": [1000, 1200, 1500, 1800, 2000],
    "r_values": [30, 60, 90],
    "top_k": 6  # Keep top 6 candidates
}

# Phase B: Medium runs on top candidates
PHASE_B = {
    "timeout": 600,  # 10 minutes each
    "top_k": 3
}

# Phase C: Long runs on best few
PHASE_C = {
    "timeout": 1200,  # 20 minutes each
    "top_k": 2
}
```

### IMPLEMENTATION STEPS

1. **Copy best submission to working directory:**
   ```bash
   cp /home/code/experiments/044_extended_subset_extraction/ensemble_044.csv submission.csv
   ```

2. **Run Phase A (15 combinations × 2 min = 30 min):**
   ```bash
   for n in 1000 1200 1500 1800 2000; do
     for r in 30 60 90; do
       timeout 120 ./bbox3_local -n $n -r $r
       # Parse final score, keep if improved
     done
   done
   ```

3. **Run Phase B on top 3 candidates (3 × 10 min = 30 min)**

4. **Run Phase C on top 2 candidates (2 × 20 min = 40 min)**

5. **Apply fix_direction after each phase**

6. **Validate and submit**

### EXPECTED OUTCOME

Based on the kernel, bbox3 running for 3+ hours can find improvements that short runs miss.
The kernel shows it can achieve scores in the 70.3x range with proper optimization.

**CRITICAL**: Even if total improvement is small (0.01-0.1), this is the highest-leverage action available.
The alternative (trying more new approaches) has been exhaustively tested and yields diminishing returns.

## ⛔ FORBIDDEN (WILL BE REJECTED)
- Running CMA-ES or Basin Hopping again - ALREADY FAILED
- Trying constructive algorithms - ALREADY FAILED
- External data mining - EXHAUSTED
- Cross-N hybridization - ALREADY FAILED
- Any approach that doesn't involve extended bbox3 optimization

## ✅ REQUIRED: SUBMIT THE RESULT
After running bbox3 for 3+ hours:
1. Validate no overlaps
2. Compute final score
3. SUBMIT to get LB feedback

We have 78 submissions remaining. USE THEM.

## ALTERNATIVE IF bbox3 DOESN'T IMPROVE

If 3+ hours of bbox3 optimization yields < 0.01 improvement:

1. **Focus on N=1 specifically** - It has 0.311 room for improvement
   - Exhaustive search over all rotation angles (0.001° resolution)
   - N=1 contributes 0.94% of total score but has most room

2. **Implement true No-Fit Polygon (NFP)** for small N
   - Precompute exact overlap-free regions
   - Use for N=2-10 where exhaustive search is feasible

3. **Study the "crystallization patterns"** from the Why Not kernel
   - Understand the lattice structure of optimal solutions
   - May reveal mathematical properties to exploit

## TRACKING

After this experiment:
1. Record the final score
2. Compare per-N scores to baseline
3. Note which (n, r) combinations worked best
4. SUBMIT to verify LB score
