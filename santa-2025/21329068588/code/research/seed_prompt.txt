# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.616068 (exp_004, hybrid ensemble)
- Best LB score: 70.622435 (exp_003, sa_fast_v2 - VALIDATED)
- Target: 68.891380 | Gap to target: 1.725 points (2.50%)
- Submissions used: 4/100 (96 remaining)

## ⚠️ CRITICAL: SUBMIT exp_004 IMMEDIATELY!
The hybrid ensemble (70.616068) has NOT been submitted to Kaggle yet.
- It's 0.006366 points better than our best validated LB (70.622435)
- We have 96 submissions remaining - USE THEM!
- Submit to verify it passes Kaggle validation

## Response to Evaluator
The evaluator correctly identified:
1. ✅ The hybrid ensemble approach is sound and exactly what top solutions use
2. ✅ N=18 tiny overlap (1e-32) is a numerical precision artifact - should pass
3. ✅ We need to expand ensemble sources and try different optimizers
4. ⚠️ The 1.725 point gap is HUGE - current improvement rate won't reach target

**Key concern**: At 0.006366 improvement per experiment, we need ~270 experiments to reach target. This is NOT sustainable. We need fundamentally better approaches.

## Score Distribution Analysis (CRITICAL INSIGHT)
- Small N (1-10): 6.1% of total score
- Medium-Small (11-30): 10.5%
- Medium (31-57): 13.9%
- Large (58-100): 21.4%
- **Very Large (101-200): 48.1%** ← FOCUS HERE!

**Packing efficiency by N:**
- N=1: 37.4% (already optimal at 45°)
- N=10: 65.7%
- N=50: 68.6%
- N=100: 72.1%
- N=200: 73.3%

**Key insight**: Large N values (101-200) contribute 48% of the score but have only 73% packing efficiency. Even small improvements here have massive impact!

## Recommended Approaches (Priority Order)

### 1. **[IMMEDIATE]** Submit exp_004 (hybrid ensemble, 70.616068)
- Verify it passes Kaggle validation
- If PASSES: New baseline at 70.616068
- If FAILS: Investigate which N value has overlap issue

### 2. **[HIGH PRIORITY]** Try sa_v1_parallel optimizer
We've tried:
- bbox3: ZERO improvement
- sa_fast_v2: 0.003653 improvement

We HAVEN'T tried:
- **sa_v1_parallel**: Uses fractional translation steps [0.001, 0.0005, 0.0002, 0.0001, 0.00005, 0.00002, 0.00001] and population-based optimization (keeps top 3)
- tree_packer_v18, tree_packer_v21
- bbox3_advanced

Location: `/home/nonroot/snapshots/santa-2025/21116303805/code/experiments/004_sa_v1_parallel/sa_v1_parallel`

### 3. **[HIGH PRIORITY]** Focus on Large N (101-200) with Tessellation
Large N contributes 48% of score but has room for improvement.
- Research shows tessellation/lattice is mathematically superior for N >= 58
- Look for tessellation-specific optimizers or approaches

### 4. **[MEDIUM PRIORITY]** Expand Ensemble Sources
The jonathanchan kernel shows top scores come from ensembling 16+ sources:
- GitHub: `https://raw.githubusercontent.com/SmartManoj/Santa-Scoreboard/main/submission.csv`
- Telegram datasets
- Multiple Kaggle datasets

Try downloading and ensembling from external sources.

### 5. **[RESEARCH]** Investigate what top teams are doing differently
- The gap of 1.725 points suggests we're missing something fundamental
- Top teams likely have better base solutions or different algorithms
- Consider: What would make a 2.5% improvement possible?

## What NOT to Try
- ❌ More bbox3 runs (already tried, ZERO improvement)
- ❌ More sa_fast_v2 runs with same parameters (diminishing returns)
- ❌ Micro-optimizations that give < 0.01 improvement

## Available Optimizers (Not Yet Tried)
1. sa_v1_parallel: `/home/nonroot/snapshots/santa-2025/21116303805/code/experiments/004_sa_v1_parallel/sa_v1_parallel`
2. tree_packer_v18: `/home/nonroot/snapshots/santa-2025/21165872902/code/tree_packer_v18`
3. tree_packer_v21: `/home/nonroot/snapshots/santa-2025/21165872902/code/tree_packer_v21`
4. bbox3_advanced: `/home/nonroot/snapshots/santa-2025/21129617858/code/bbox3_advanced`

## Validation Notes
- CV scheme: Local scoring matches Kaggle perfectly (CV-LB gap = 0)
- Overlap detection: Use high-precision Shapely with scale_factor=1e15
- N=8 is problematic: Previous submissions failed due to overlaps in group 008
- Always verify N=8 matches a Kaggle-validated submission

## SUBMISSION STRATEGY
- Remaining submissions: 96
- Submit after EVERY experiment - LB feedback is free information!
- Even if worse than baseline, submit to learn what doesn't work
