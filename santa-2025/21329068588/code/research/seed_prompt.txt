# Santa 2025 - Christmas Tree Packing Optimization

## Current Status
- Best CV score: 70.626088 (from validated snapshot 21198927060/candidate_024.csv)
- Best LB score: 70.626088 (validated by Kaggle)
- Target: 68.892266 | Gap to target: 1.73 points (2.5%)

## CRITICAL LESSON FROM LOOP 3

**The submission failed because we used an UNVALIDATED submission as the starting point!**

- bbox3 started from snapshot 21198927060/submission.csv (70.624424)
- This submission was NEVER validated by Kaggle - it already had overlaps
- The error "Overlapping trees in group 008" was NOT introduced by bbox3
- **ALWAYS use Kaggle-validated submissions as starting points**

Best validated submissions:
1. `/home/nonroot/snapshots/santa-2025/21198927060/code/submission_candidates/candidate_024.csv` (LB: 70.626088)
2. `/home/nonroot/snapshots/santa-2025/21198893057/code/submission.csv` (LB: 70.627582)

## Response to Evaluator

The evaluator correctly identified:
1. ✓ bbox3 achieved ZERO improvement - the solution is at a local optimum
2. ✓ We need fundamentally different approaches
3. ✓ Try sa_fast_v2 as an alternative optimizer

However, the evaluator missed a critical issue:
- The source submission (70.624424) was NEVER validated by Kaggle
- It already had overlaps that caused the submission failure
- This is why the submission failed, not because bbox3 introduced overlaps

## What Has Been Tried (From Snapshot 21198927060)

The snapshot ran **25 experiments** with these approaches:
1. ❌ Ensemble from multiple sources - no improvement
2. ❌ bbox3 optimization - no improvement
3. ❌ Zaburo grid initialization - no improvement
4. ❌ SA optimization - no improvement
5. ❌ Fractional translation - no improvement
6. ❌ Tessellation SA - WORSE than baseline
7. ❌ Random restart SA - no improvement
8. ❌ Scanline packer - no improvement
9. ❌ Long SA runs - no improvement
10. ❌ Basin hopping - no improvement
11. ❌ Constraint programming - no improvement
12. ✓ Rebuild from corners - small improvement (70.630465)
13. ✓ Cross-N extraction - small improvement
14. ❌ Egortrushin tessellation - no improvement
15. ✓ C++ SA - small improvement (70.630455)
16. ❌ Asymmetric solutions - no improvement
17. ✓ Tessellation search - small improvement (70.630429)
18. ✓ Exhaustive small N - improvement (70.627582)
19. ✓ Iterative refinement - best improvement (70.626088)

**Key insight**: 25 experiments only improved by 0.02 points (70.647 → 70.626). The solution is deeply stuck at a local optimum.

## Recommended Approaches (Priority Order)

### 1. [HIGHEST PRIORITY] Submit the validated baseline to establish LB score
Before trying anything else, submit the validated candidate_024.csv (70.626088) to:
- Confirm it passes Kaggle validation
- Establish our current best LB score
- Have a reliable baseline for comparison

### 2. [HIGH PRIORITY] Try sa_fast_v2 optimizer
The sa_fast_v2 uses a different algorithm than bbox3:
- Simulated Annealing with fractional translation
- Very fine steps (down to 0.00001)
- Multiple generations with perturbation

```bash
cp /home/nonroot/snapshots/santa-2025/21198927060/code/submission_candidates/candidate_024.csv submission.csv
./sa_fast_v2 -i submission.csv -n 15000 -r 80
```

### 3. [MEDIUM PRIORITY] Backward propagation (chistyakov approach)
The chistyakov kernel uses a novel approach:
- Start from N=200, work backward to N=2
- For each N, try removing each tree that touches the bounding box
- If resulting (N-1) config is better than stored, save it

This is fundamentally different from forward optimization.

### 4. [MEDIUM PRIORITY] Research novel algorithms
The gap is 1.73 points (2.5%). This is too large for incremental optimization.
Consider:
- No-Fit Polygon (NFP) precomputation for O(1) overlap checks
- Branch-and-bound for small N (guarantee optimal)
- Genetic algorithms with custom crossover operators

### 5. [LOW PRIORITY] External sources
The jonathanchan kernel mentions external sources:
- GitHub: SmartManoj/Santa-Scoreboard
- Telegram shared solutions

But our analysis showed these are WORSE than our current best (70.743 vs 70.626).

## What NOT to Try
- ❌ bbox3 with more iterations (already tried, ZERO improvement)
- ❌ Starting from unvalidated submissions (causes overlap errors)
- ❌ Simple SA variations (25 experiments already tried this)
- ❌ Tessellation for large N (snapshot showed it's WORSE)

## Validation Notes
- ALWAYS use Kaggle-validated submissions as starting points
- The best validated submission is candidate_024.csv (LB: 70.626088)
- Check for overlaps before submitting using high-precision Decimal arithmetic

## SUBMISSION STRATEGY
- Remaining submissions: 97
- **SUBMIT AGGRESSIVELY** - we have abundant submissions
- Submit after EVERY experiment to get LB feedback
- LB feedback is free information - USE IT!
