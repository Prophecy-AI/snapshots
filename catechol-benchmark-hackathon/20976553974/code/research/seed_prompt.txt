# Catechol Reaction Yield Prediction - Evolved Seed Prompt (Loop 26)

## Current Status
- **Best CV score**: 0.0623 from exp_004 (and 9 other identical experiments)
- **Best LB score**: 0.0956 from exp_004/exp_016
- **CV-LB gap**: ~53% consistently (LB ≈ 1.001*CV + 0.032)
- **Target**: 0.01727 (5.5x better than best LB)
- **Submissions**: 5/5 used, **1 REMAINING** (CRITICAL)
- **Latest exp_026**: CV 0.0772 (WORSE than exp_004, DO NOT SUBMIT)

## Response to Evaluator

**Technical verdict was CONCERNS** - AGREED:
1. Template compliance issue (cell 10 after final cell) - MUST FIX before submission
2. CV 0.0772 is 24% worse than exp_004's 0.0623 - DO NOT SUBMIT exp_026

**Key finding from analysis**:
- Linear fit: LB = 1.001*CV + 0.032 (R² = 0.988)
- CV-LB correlation is 0.994 - lower CV reliably predicts lower LB
- To reach target LB 0.01727, would need CV = -0.015 (IMPOSSIBLE with current approach!)
- This means we need a FUNDAMENTALLY DIFFERENT approach with different CV-LB relationship

**Research finding (arXiv:2512.19530)**:
- GNN with GAT + DRFP achieves MSE 0.0039 on Catechol Benchmark (25x better than tabular!)
- MSE 0.0039 ≈ MAE 0.06 (similar to our CV!)
- GNNs may have different CV-LB relationship - this is the path forward

## Data Understanding

**Reference notebooks:**
- `exploration/evolver_loop26_analysis.ipynb` - CV-LB correlation analysis

**Key patterns:**
1. **10 experiments achieved CV 0.0623** - This is a local optimum we can't escape with tabular methods
2. **Best approach**: Per-target HGB+ETR with 0.8 ACS_PCA + 0.2 Spange, NO TTA
3. **CV-LB gap is ~50% consistently** - Test set has fundamentally different solvents

## CRITICAL STRATEGIC DECISION

With only 1 submission remaining and a 5.5x gap to target:

### RECOMMENDED: CONTINUE EXPERIMENTING
Focus on finding an approach with CV significantly better than 0.0623:
1. **Implement proper GNN** with molecular graph features (HIGHEST PRIORITY)
2. **Try transfer learning** from pre-trained models
3. **Only submit when CV < 0.056** (at least 10% improvement)

## Recommended Approaches (Priority Order)

### Priority 1: IMPLEMENT PROPER GNN (HIGHEST POTENTIAL)
**Why**: Research shows GNNs achieve 25x better MSE than tabular methods on this benchmark.

**Implementation**:
```python
# Use PyTorch Geometric
# Encode molecules as graphs (atoms = nodes, bonds = edges)
# Use GAT (Graph Attention Network) for message passing
# Combine with DRFP (Differential Reaction Fingerprints)
# Add continuous mixture encoding for solvent blends
```

**Key components**:
1. **Molecular graph encoding**: Use RDKit to generate graphs
2. **Atom features**: element, charge, hybridization, aromaticity
3. **Bond features**: type, conjugation, ring membership
4. **Process features**: temperature, residence time (Arrhenius)
5. **Solvent features**: Spange descriptors, mixture encoding

### Priority 2: TRANSFER LEARNING
**Why**: Pre-trained molecular embeddings may generalize better.

**Implementation**:
- Use ChemBERTa or similar pre-trained model
- Fine-tune on Catechol data
- Combine with process features

### Priority 3: ENSEMBLE OF DIVERSE MODELS
**Why**: Different models capture different patterns.

**Implementation**:
- Combine: HGB + ETR + Ridge + GP + MLP
- Use different feature subsets for each
- Weight by inverse CV error

## What NOT to Try

1. **exp_026 or similar ultra-simple models** - CV was worse (0.0772 vs 0.0623)
2. **GroupKFold** - Breaks submission format (24/13 folds required)
3. **TTA for mixed solvents** - Proven to hurt performance
4. **Morgan fingerprints** - High-dimensional, causes overfitting
5. **More regularization** - exp_021 showed stronger regularization HURT performance
6. **Incremental improvements** - Need paradigm shift, not 1-2% gains

## Validation Notes

- **MUST use LOO validation** (24 folds for single, 13 for full)
- **CV-LB correlation is 0.994** - Trust CV, lower CV = lower LB
- **Template compliance**: Last 3 cells must match template, NO cells after

## Competition-Specific Constraints (MUST FOLLOW)

**MANDATORY SUBMISSION STRUCTURE:**
- Last 3 cells MUST match template exactly
- ONLY the model definition line can change
- NO cells after the final cell

## Next Experiment Recommendation

**Experiment 027: GNN with Molecular Graph Features**

The hypothesis: GNNs can capture molecular structure information that tabular methods miss, potentially achieving the breakthrough needed to reach the target.

Key implementation:
1. **Graph representation**: 
   - Encode molecules as graphs (atoms = nodes, bonds = edges)
   - Use RDKit to generate molecular graphs
   - Include atom features (element, charge, hybridization)
   - Include bond features (type, conjugation, ring membership)

2. **Model architecture**:
   - GAT (Graph Attention Network) for message passing
   - Combine with process features (temperature, time)
   - Combine with solvent descriptors (Spange)

3. **Training**:
   - Use LOO validation (24/13 folds)
   - Early stopping to prevent overfitting
   - Learning rate scheduling

**Expected outcome**:
- If GNN works, CV could improve significantly
- If CV < 0.056 (10% improvement), consider submitting

## STRATEGIC REMINDER

**DO NOT GIVE UP**. The target IS reachable.

Key insights:
1. CV-LB correlation is very high (0.994) - focus on minimizing CV
2. Current best CV (0.0623) is a local optimum - need paradigm shift
3. GNNs achieve 25x better MSE on this benchmark - this is the path forward
4. Only submit when CV is significantly better than 0.0623

The target 0.01727 IS achievable - someone achieved it. We need to find the right approach.